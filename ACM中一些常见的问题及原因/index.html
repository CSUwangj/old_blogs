<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">



  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">







  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="最近在 ACM 群灌水，顺便解决了一点问题，感觉可能会成为日经系列，寻思可以写个博文专门写写，正好也是对自己学习知识的检验。 我觉得这篇文章阅读方式可以按照《C语言常见问题集》，遇到问题了来看看也行，电脑阅读的时候右边应该会有个目录可以跳转，顺着读一遍也行。 文章只能慢慢更新，因为我并不想随意地对待这种难得的问题，然而工作在身并不能全身心投入。 以下内容如无特殊声明，采用C99和C++11标准。">
<meta name="keywords" content="ACM">
<meta property="og:type" content="article">
<meta property="og:title" content="ACM中一些常见的问题及原因">
<meta property="og:url" content="http://CSUwangj.github.io/ACM中一些常见的问题及原因/index.html">
<meta property="og:site_name" content="LuckyDog">
<meta property="og:description" content="最近在 ACM 群灌水，顺便解决了一点问题，感觉可能会成为日经系列，寻思可以写个博文专门写写，正好也是对自己学习知识的检验。 我觉得这篇文章阅读方式可以按照《C语言常见问题集》，遇到问题了来看看也行，电脑阅读的时候右边应该会有个目录可以跳转，顺着读一遍也行。 文章只能慢慢更新，因为我并不想随意地对待这种难得的问题，然而工作在身并不能全身心投入。 以下内容如无特殊声明，采用C99和C++11标准。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573525655820.png">
<meta property="og:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573526342103.png">
<meta property="og:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573525655820.png">
<meta property="og:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573571964453.png">
<meta property="og:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573577931809.png">
<meta property="og:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573619928591.png">
<meta property="og:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573620431685.png">
<meta property="og:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573620523529.png">
<meta property="og:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573620621212.png">
<meta property="og:updated_time" content="2020-06-16T09:27:55.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ACM中一些常见的问题及原因">
<meta name="twitter:description" content="最近在 ACM 群灌水，顺便解决了一点问题，感觉可能会成为日经系列，寻思可以写个博文专门写写，正好也是对自己学习知识的检验。 我觉得这篇文章阅读方式可以按照《C语言常见问题集》，遇到问题了来看看也行，电脑阅读的时候右边应该会有个目录可以跳转，顺着读一遍也行。 文章只能慢慢更新，因为我并不想随意地对待这种难得的问题，然而工作在身并不能全身心投入。 以下内容如无特殊声明，采用C99和C++11标准。">
<meta name="twitter:image" content="http://csuwangj.github.io/ACM中一些常见的问题及原因/1573525655820.png">



  <link rel="alternate" href="/atom.xml" title="LuckyDog" type="application/atom+xml" />




  <link rel="canonical" href="http://CSUwangj.github.io/ACM中一些常见的问题及原因/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>ACM中一些常见的问题及原因 | LuckyDog</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">LuckyDog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">CSUwangj</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="找点exciting的东西" spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://CSUwangj.github.io/ACM中一些常见的问题及原因/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CSUwangj">
      <meta itemprop="description" content="Just keep in mind that hacking is very rarely in a sequence.">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LuckyDog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">ACM中一些常见的问题及原因
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-01-30 17:23:34" itemprop="dateCreated datePublished" datetime="2019-01-30T17:23:34+08:00">2019-01-30</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-06-16 17:27:55" itemprop="dateModified" datetime="2020-06-16T17:27:55+08:00">2020-06-16</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/ACM中一些常见的问题及原因/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="ACM中一些常见的问题及原因/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">9.3k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">16 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <p>最近在 ACM 群灌水，顺便解决了一点问题，感觉可能会成为日经系列，寻思可以写个博文专门写写，正好也是对自己学习知识的检验。</p>
<p>我觉得这篇文章阅读方式可以按照《C语言常见问题集》，遇到问题了来看看也行，电脑阅读的时候右边应该会有个目录可以跳转，顺着读一遍也行。</p>
<p>文章只能慢慢更新，因为我并不想随意地对待这种难得的问题，然而工作在身并不能全身心投入。</p>
<p>以下内容如无特殊声明，采用C99和C++11标准。</p>
<a id="more"></a>
<h1 id="为什么在读入的时候不加-amp-经常会-RE，但是数组名不加-amp-就没问题？"><a href="#为什么在读入的时候不加-amp-经常会-RE，但是数组名不加-amp-就没问题？" class="headerlink" title="为什么在读入的时候不加&amp;经常会 RE，但是数组名不加&amp;就没问题？"></a>为什么在读入的时候不加&amp;经常会 RE，但是数组名不加&amp;就没问题？</h1><p>我们直接来看一段代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译运行的结果基本是<code>Segmentation fault (core dumped)</code>，如果是在windows上用codeblocks、devcpp之类的写的程序，多半会看到<img src="/ACM中一些常见的问题及原因/1573525655820.png" width="1573525460495">或者<img src="/ACM中一些常见的问题及原因/1573526342103.png" width="1573526342103">如果是devcpp，还可能是在一段时间的无响应后退出，同时返回值是一个大得惊人的数字<img src="/ACM中一些常见的问题及原因/1573525655820.png" width="1573525655820"></p>
<p>这里我们需要对比一下<code>a</code>和<code>&amp;a</code>的区别，我们先直接把它们打印出来看一下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%x\n%x\n"</span>, a, &amp;a); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>%x</code>的意思是按十六进制打印，运行我们应该会看到类似如下的结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜  ./format</span><br><span class="line">0  <span class="comment"># 这里值不一定，也可能不是0</span></span><br><span class="line">f35ab98c <span class="comment"># 这里的值也不一定，但是通常会很大，比如这个十六进制转成十进制就是‭3759417480‬</span></span><br></pre></td></tr></table></figure>
<p>这里我们再进一步，做一个测试，首先我们改写程序，其次用系统工具查看一下系统调用。</p>
<p>先介绍一下我们用到的工具：</p>
<p><code>echo</code>是能将输入原样输出的一个程序，如果下面是一个运行的例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  <span class="built_in">echo</span> 12341234</span><br><span class="line">12341234</span><br></pre></td></tr></table></figure>
<p><code>ltrace</code>是一个能跟踪库函数调用的工具，也就是说它能追踪到你程序调用的库里的类似<code>scanf</code>、<code>printf</code>这样的函数并且把调用函数的参数打印出来。</p>
<p>然后我们对下面这段程序使用上面写的工具，把<code>1234 1234</code>作为输入喂给程序。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, a);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, &amp;a);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">➜  <span class="built_in">echo</span> <span class="string">"1234 1234"</span> | ltrace ./format</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, 0)                                             = 1</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, -787805524)                                    = 10</span><br><span class="line">__isoc99_scanf(0x7fa859609004, 0x7fffd10b0aac, 0x7fa85959d8c0, 0) = 1</span><br><span class="line">__isoc99_scanf(0x7fa859609004, 1234, 0x7fa85959d8d0, 16 &lt;no <span class="built_in">return</span> ...&gt;</span><br><span class="line">--- SIGSEGV (Segmentation fault) ---</span><br><span class="line">+++ killed by SIGSEGV +++</span><br></pre></td></tr></table></figure>
<p>我们可以看到，<code>printf</code>打印出了<code>a</code>的值，也就是<code>0</code>，同时第一个赋值没有出错，将<code>a</code>改为了1234，但是接下来的一行代码又出现了1234这个数字<code>__isoc99_scanf(0x7fa859609004, 1234, 0x7fa85959d8d0, 16 &lt;no return ...&gt;</code>。重复实验并且改变输入的数字，会发现这一行调用函数的第二个参数总是我们输入的第一个数字，也就是第一次给a赋值并成功的结果。</p>
<p>学过操作系统的同学或者对计算机组成有所了解的同学会知道，程序运行时的各种所需都是存储在内存里的，变量也不例外，而它们在内存里都是有个地址的。基于这些知识和刚才实验的结果，我们可以推测，<code>scanf(&quot;%d&quot;, a);</code>是将a的值认为是一个指针的地址并尝试向里面写入数据，但是a的默认值并不一定是一块给写数据的内存空间，这时候就引发了一个错误。</p>
<p>接下来让我们到<code>scanf</code>的<a href="http://man7.org/linux/man-pages/man3/scanf.3.html" target="_blank" rel="noopener">manual page</a>看看描述。</p>
<p>这里我把关键的两段截出来，其他部分对这个问题帮助不大所以就自己看了。重点看加粗部分</p>
<blockquote>
<pre><code>The scanf() family of functions scans input according to *format* as
described below.  This format may contain *conversion specifications*;
the results from such conversions, **if any, are stored in the
locations pointed to by the *pointer* arguments that follow format**.
Each pointer argument must be of a type that is appropriate for the
value returned by the corresponding conversion specification.

**If the number of conversion specifications in format exceeds the
number of pointer arguments, the results are undefined.  If the
number of pointer arguments exceeds the number of conversion
specifications, then the excess pointer arguments are evaluated, but
are otherwise ignored.**
</code></pre></blockquote>
<p>这里format指的是<a href="https://en.wikipedia.org/wiki/Printf_format_string" target="_blank" rel="noopener">格式化字符串</a>，简单来说就是printf/printf的第一个参数，fscanf/fprintf的第二个参数，而这个字符串里的conversion specifications（中文维基直译为转换说明）就是指指定类型的那个e/p/d/x，比如%d中的d。同时从这里可能也就能理解为什么要叫printf/scanf而不叫print/scan，因为这是print format/scan format的简写。顺便一提，格式化字符串还是一类漏洞的名称，有兴趣的话不妨搜索了解一下。</p>
<p>然后回到话题，看到第一处加粗的文字，也就是说，若里面有类似%d这样的参数，而且也有对应的参数（比如<code>scanf(&quot;%d&quot;, a)；</code>里的a就是%d对应的参数）scanf会按照格式读入数据（并将其转化为二进制表示），然后存入对应<strong>指针</strong>参数指向的地址。也就是说它把后面的参数认为是指针了。</p>
<p>这里C语言熟练的朋友就知道，局部自动(auto)变量定义时候不会隐式初始化，所以a的值是不确定的，把它直接给scanf用的结果大抵相当于向野指针指的地方写数据。所以段错误什么的很正常吧，</p>
<p>那么为什么下面这段代码不会出错呢？</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, a);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, &amp;a);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>因为数组名是常量指针。</p>
</blockquote>
<p>肯定有认真听课的这样回答，但是很遗憾，不是的。数组名不是指针，但是它的确被转换成了指针。具体的内容可以搜索《说出来你们可能不信，但是数组名确实不是指针常量》。但是这个东西并不太重要，如果不当语言律师也没打算深度钻研C，也没有必要理解。</p>
<h1 id="在函数里开不了大数组吗？"><a href="#在函数里开不了大数组吗？" class="headerlink" title="在函数里开不了大数组吗？"></a>在函数里开不了大数组吗？</h1><p>这里我们继续用代码做实验</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">524288</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"OK\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译运行，程序多半并不能让我们看到<code>OK</code>，而是会出现和前面一样的情况，也就是段错误。（如果没出现就把这个数字翻几倍就能看到效果了）。</p>
<p>简单来说的话，函数中声明定义的非全局、非static，且没有使用<code>*alloc</code>、<code>new</code>产生的变量都会被放在栈上，栈的大小由编译选项决定，在我的电脑上大致就是能开500,000个int的大小。也可以在OJ上测试一下栈的大小，但同时并不建议在栈上开这么大，在ACM中还是全局的数组比较好用。</p>
<h1 id="我开了一个很大的全局数组，但是编译无法通过，这是为什么？"><a href="#我开了一个很大的全局数组，但是编译无法通过，这是为什么？" class="headerlink" title="我开了一个很大的全局数组，但是编译无法通过，这是为什么？"></a>我开了一个很大的全局数组，但是编译无法通过，这是为什么？</h1><p>编译器会阻止你开一个大小超过size_t表达范围的数组，也就是<code>sizeof</code>不会超过表达范围导致溢出的范围。而size_t是一个和平台相关的数据结构，在32位Linux机下，有以下结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@vultr:~<span class="comment"># cat test.c</span></span><br><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line">int a[10000000000];</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n%d"</span>,sizeof(size_t),sizeof(long long));</span><br><span class="line">        <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">root@vultr:~<span class="comment"># gcc test.c  -o test</span></span><br><span class="line">test.c:2:5: error: size of array ‘a’ is too large</span><br><span class="line"> int a[10000000000];</span><br><span class="line">     ^</span><br></pre></td></tr></table></figure>
<p>而在64位Linux机下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">root@vultr:~<span class="comment"># cat test.c</span></span><br><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line">int a[10000000000];</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n%d"</span>,sizeof(size_t),sizeof(long long));</span><br><span class="line">                        <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">root@vultr:~<span class="comment"># gcc test.c -o test</span></span><br><span class="line">root@vultr:~<span class="comment"># cat test2.c</span></span><br><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line">int a[10000000000000000000];</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n%d"</span>,sizeof(size_t),sizeof(long long));</span><br><span class="line">                        <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">root@vultr:~<span class="comment"># gcc test2.c -o test2</span></span><br><span class="line">test2.c:2:5: error: size of array ‘a’ is too large</span><br><span class="line"> int a[10000000000000000000];</span><br><span class="line">     ^</span><br></pre></td></tr></table></figure>
<h1 id="我开了一个稍小一些的全局数组，为什么编译还是失败了而且错误的原因非常复杂？"><a href="#我开了一个稍小一些的全局数组，为什么编译还是失败了而且错误的原因非常复杂？" class="headerlink" title="我开了一个稍小一些的全局数组，为什么编译还是失败了而且错误的原因非常复杂？"></a>我开了一个稍小一些的全局数组，为什么编译还是失败了而且错误的原因非常复杂？</h1><p>把错误名单上下拉动找一下，通常能看到下图类似的东西，说明你遇到的正是我现在要说的这个问题：</p>
<img src="/ACM中一些常见的问题及原因/1573571964453.png" width="1573571964453">
<p>首先需要了解的知识是一个可执行文件的文件格式，在Windows上的是PE文件格式（包括<code>.exe</code>、<code>.dll文</code>件），Linux上则是ELF文件。不过这里不做深入解析，大家只需要知道这些文件的一个构成部分是各种节。</p>
<p>在Linux上使用<code>size</code>这个工具可以查看ELF文件的各个节的大小，这里我们准备三份代码，编译并使用size查看。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// where_is_global.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1024</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%OK"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// where_is_global2.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">2048</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%OK"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// where_is_global3.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1024</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%OK"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ size where_is_global</span><br><span class="line">   text    data     bss     dec     hex filename</span><br><span class="line">   1467     584    4128    6179    1823 where_is_global</span><br><span class="line">$ size where_is_global2</span><br><span class="line">   text    data     bss     dec     hex filename</span><br><span class="line">   1467     584    8224   10275    2823 where_is_global2</span><br><span class="line">$ size where_is_global3</span><br><span class="line">   text    data     bss     dec     hex filename</span><br><span class="line">   1467     584    4128    6179    1823 where_is_global3</span><br></pre></td></tr></table></figure>
<p>可以看到区别仅在于bss所对应的数字，也就是说默认情况下，全局变量在编译后文件存放于.bss节，这也就是出现问题的原因。</p>
<p>默认情况下gcc对节的大小做了限制，如果超过的情况下就会出现这样的错误。但是这个是可以通过编译选项调整的，所以在不同的OJ上可能有不同的结果，在不同的环境下也不一定都能触发这个错误，下面是一份能在我的电脑上（Windows10 1903 Build, devcpp）触发的代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1000000000000000000L</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%dK\n"</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="我开了一个很大的全局数组并且通过了编译，可是为什么程序运行依然RE了？（等待更好的答案）"><a href="#我开了一个很大的全局数组并且通过了编译，可是为什么程序运行依然RE了？（等待更好的答案）" class="headerlink" title="我开了一个很大的全局数组并且通过了编译，可是为什么程序运行依然RE了？（等待更好的答案）"></a>我开了一个很大的全局数组并且通过了编译，可是为什么程序运行依然RE了？（等待更好的答案）</h1><p>这里我也没有一个十分确定的答案，先直接给一个在我电脑上可以触发这样错误的程序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> a[<span class="number">1000000000000L</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%dK\n"</span>,a[<span class="number">1000000000L</span> - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来我们深入到程序编译成的汇编代码里调试看一下，发现RE是出现在<img src="/ACM中一些常见的问题及原因/1573577931809.png" width="1573579083511"></p>
<p>后来找了办法确定了RAX里存放的是数组的地址，但是除此之外也不知道为什么会出这个错。</p>
<p>我理解来电脑不应该分配那么多内存，也就是分配阶段就应该出问题了，而不是在写东西的时候才有问题。</p>
<hr>
<p>和<a href="https://blog.yuki-nagato.com/" target="_blank" rel="noopener">yuki nagato</a>讨论有了一个新的猜测</p>
<blockquote>
<p>yuki nagato<br>关于这个问题，我觉得应该是因为未初始化的全局变量位于bss段，系统在程序开始执行时只是记录了它的大小，没有给它实际分配内存</p>
<p>yuki nagato<br>在首次访问的时候，系统会给它分配全零的页面，这时候会触发相关的错误</p>
<p>CSUwangj<br>嗯嗯，感觉你说的有道理</p>
<p>CSUwangj<br>这样子的话，我想想有没有办法验证</p>
<p>CSUwangj<br>似乎直接调试windows可能可以验证这个</p>
</blockquote>
<p>但是由于本人调试Windows经验不足，验证期限无限期延长...欢迎大牛帮帮忙提提PR</p>
<h1 id="为什么越界会导致-RE？"><a href="#为什么越界会导致-RE？" class="headerlink" title="为什么越界会导致 RE？"></a>为什么越界会导致 RE？</h1><p>一句话回答就是，越界写会导致向不该写的地方写入数据。</p>
<p>详细展开的话，如果是对函数里的局部变量进行了越界写，那么可能会破坏程序运行时的调用栈，导致返回地址改变，这类情况也可以归结为栈溢出，而且这个名称同时也对应了历史上一类很有名的漏洞——<a href="https://www.52pojie.cn/thread-974510-1-1.html" target="_blank" rel="noopener">栈溢出漏洞</a>。</p>
<p>如果是对static变量、局部变量、使用new或者*alloc分配的变量进行越界写，因为它们分配在堆上，造成的问题也就是堆溢出，同样的，堆溢出也对应了<a href="https://cloud.tencent.com/developer/article/1083866" target="_blank" rel="noopener">堆溢出漏洞</a>。</p>
<p>除此之外还有一种情况就是OJ的编译器对于越界做了特殊的判断，导致一旦出现越界写程序就会强制报错并结束，这样的情况虽然越界写没有对程序运行造成影响，也还是报了RE。</p>
<h1 id="为什么有时候越界不会-RE-但是会-TLE-WA？"><a href="#为什么有时候越界不会-RE-但是会-TLE-WA？" class="headerlink" title="为什么有时候越界不会 RE 但是会 TLE/WA？"></a>为什么有时候越界不会 RE 但是会 TLE/WA？</h1><p>在<a href="#为什么在读入的时候不加&amp;经常会 RE，但是数组名不加&amp;就没问题？">第一个问题</a>中我们看到了，对程序进行的赋值操作其实也就是对对应内存的写入操作（不考虑利用寄存器优化的情况），同时我们可以用<code>printf(&quot;%p&quot;, &amp;a);</code>这样的语句来查看变量a所在内存的地址。那么有以下代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">16</span>], b[<span class="number">16</span>], t;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%p %p %p\n"</span>, &amp;a, &amp;b, &amp;t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">34</span> ; ++ i)&#123;</span><br><span class="line">        a[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span> ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, t);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>已知第一行输出为<code>000000000062FD90 000000000062FDD0 000000000062FE14</code>，那么第二行输出是什么？（不要忘记考虑在我电脑上<code>sizeof(int)==4</code>）</p>
<p>答案是<code>16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 33</code></p>
<img src="/ACM中一些常见的问题及原因/1573619928591.png" width="1573619950147">
<p>虽然变量在内存里的布局在C语言中是未定义的，但是通常来说它们根据情况（是否在同一函数、是否是全局/static变量、是否通过new/*alloc分配）占据一片空间的相邻位置。在这样的情况下越界写就会改变相邻变量的内容，于是导致WA（恰好改变了答案）、TLE（改变了循环用的计数器）也就不难理解了。</p>
<h1 id="我只定义过一个-left，为什么编译器告诉我-Error-reference-to-39-left-39-is-ambiguous？"><a href="#我只定义过一个-left，为什么编译器告诉我-Error-reference-to-39-left-39-is-ambiguous？" class="headerlink" title="我只定义过一个 left，为什么编译器告诉我[Error] reference to &#39;left&#39; is ambiguous？"></a>我只定义过一个 left，为什么编译器告诉我<code>[Error] reference to &#39;left&#39; is ambiguous</code>？</h1><p>如果你仔细查看报错信息，应该会看到类似</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">916    3    &#123;PATH&#125;    [Note] std::ios_base&amp; std::left(std::ios_base&amp;)</span><br></pre></td></tr></table></figure>
<p>出现这种问题是因为引入的头文件中的变量，比如left这个是在<code>bits/ios_base.h</code>里，而<code>algorithm</code>里有count这样的函数。</p>
<p>这些变量通常都在有两种方法可以解决，一是不要使用<code>using namespace std;</code>这个语句，另一个是不要用类似<code>left</code>, <code>count</code>这样的名称。从工程角度来说，第一个做法是比较合理的。</p>
<h1 id="Error-ld-returned-1-exit-status是什么错误？"><a href="#Error-ld-returned-1-exit-status是什么错误？" class="headerlink" title="[Error] ld returned 1 exit status是什么错误？"></a>[Error] ld returned 1 exit status是什么错误？</h1><p>一个C语言源代码到可执行文件之间需要经过预处理、编译、汇编、链接几个过程，ld(Linux)或者ld.exe(Windows)是GCC使用的链接器。</p>
<p>这个错误只是说明了链接器运行失败，但是具体的错误要向上找一两行才知道是为什么，这里举几个常见的例子：（欢迎补充）</p>
<h2 id="additional-relocation-overflows-omitted-from-the-output"><a href="#additional-relocation-overflows-omitted-from-the-output" class="headerlink" title="additional relocation overflows omitted from the output"></a>additional relocation overflows omitted from the output</h2><img src="/ACM中一些常见的问题及原因/1573620431685.png" width="1573620431685">
<p>见<a href="#我开了一个稍小一些的全局数组，为什么编译还是失败了而且错误的原因非常复杂？">我开了一个稍小一些的全局数组，为什么编译还是失败了而且错误的原因非常复杂？</a></p>
<h2 id="undefined-reference-to-WinMain-39"><a href="#undefined-reference-to-WinMain-39" class="headerlink" title="undefined reference to `WinMain&#39;"></a>undefined reference to `WinMain&#39;</h2><img src="/ACM中一些常见的问题及原因/1573620523529.png" width="1573620523529">
<p>缺少main函数，通常是因为把main打成了mian</p>
<h2 id="cannot-open-output-file-这里是个路径-Permission-denied"><a href="#cannot-open-output-file-这里是个路径-Permission-denied" class="headerlink" title="cannot open output file [这里是个路径]: Permission denied"></a>cannot open output file [这里是个路径]: Permission denied</h2><img src="/ACM中一些常见的问题及原因/1573620621212.png" width="1573620621212">
<p>没有关闭正在运行的程序导致ld无法更新编译出来的.exe</p>
<h1 id="总是说的堆栈，是指什么？是数据结构里的堆和栈吗？"><a href="#总是说的堆栈，是指什么？是数据结构里的堆和栈吗？" class="headerlink" title="总是说的堆栈，是指什么？是数据结构里的堆和栈吗？"></a>总是说的堆栈，是指什么？是数据结构里的堆和栈吗？</h1><p>这里指的是操作系统里的堆栈，和数据结构里的堆、栈不是一个东西。</p>
<p>这些前置知识能在《计算机组成原理》《操作系统》这样的书籍里找到，这里因为笔者学艺不精，不敢妄言，如果有大牛愿意贡献这部分的内容，欢迎在<a href="https://github.com/CSUwangj/ACM_Weird_Problem" target="_blank" rel="noopener">repo</a>里提PR。</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li>scanf manual page<ul>
<li><a href="http://man7.org/linux/man-pages/man3/scanf.3.html" target="_blank" rel="noopener">http://man7.org/linux/man-pages/man3/scanf.3.html</a></li>
</ul>
</li>
<li>格式化字符串<ul>
<li><a href="https://en.wikipedia.org/wiki/Printf_format_string" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Printf_format_string</a></li>
</ul>
</li>
<li>如何调整GCC编译程序的默认栈大小<ul>
<li><a href="http://www.cplusplus.com/forum/general/134645/" target="_blank" rel="noopener">http://www.cplusplus.com/forum/general/134645/</a></li>
</ul>
</li>
<li>Why is the maximum size of an array “too large”?<ul>
<li><a href="https://stackoverflow.com/a/42575849" target="_blank" rel="noopener">https://stackoverflow.com/a/42575849</a></li>
</ul>
</li>
<li>GCC compile option<ul>
<li><a href="https://gcc.gnu.org/onlinedocs/gcc-4.6.0/gcc/i386-and-x86_002d64-Options.html#i386-and-x86_002d64-Options" target="_blank" rel="noopener">https://gcc.gnu.org/onlinedocs/gcc-4.6.0/gcc/i386-and-x86_002d64-Options.html#i386-and-x86_002d64-Options</a></li>
</ul>
</li>
<li>栈基础 &amp; 栈溢出 &amp; 栈溢出进阶<ul>
<li><a href="https://www.52pojie.cn/thread-974510-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-974510-1-1.html</a></li>
</ul>
</li>
<li>0Day技术分析-4-堆溢出原理<ul>
<li><a href="https://cloud.tencent.com/developer/article/1083866" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1083866</a></li>
</ul>
</li>
</ul>

      
    </div>

    
      

  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
  
    <li class="popular-posts-item">
      
        <div class="popular-posts-date">2018-06-03</div>
      
      
      <div class="popular-posts-title"><a href="/关于散列函数的一点思考/" rel="bookmark">关于散列函数的一点思考</a></div>
      
    </li>
  
  </ul>


    

    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>欢迎请我喝听肥仔快乐水~</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>资瓷一下</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="CSUwangj 鹅厂支付"/>
        <p>鹅厂支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/Alipay.jpg" alt="CSUwangj 月饼厂支付"/>
        <p>月饼厂支付</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>CSUwangj</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://CSUwangj.github.io/ACM中一些常见的问题及原因/" title="ACM中一些常见的问题及原因">http://CSUwangj.github.io/ACM中一些常见的问题及原因/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc/4.0/" rel="external nofollow" target="_blank">CC BY-NC 4.0</a> 许可协议。欢迎你将我的收获分享出去，记得署名哟~</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ACM/" rel="tag"># ACM</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/又一次装机/" rel="next" title="又一次装机">
                <i class="fa fa-chevron-left"></i> 又一次装机
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/ACTF-Junior-2019-Official-WriteUP-of-CSUWangj-s-Challenge/" rel="prev" title="ACTF Junior 2019 Official WriteUP of CSUWangj's Challenge">
                ACTF Junior 2019 Official WriteUP of CSUWangj's Challenge <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="CSUwangj" />
            
              <p class="site-author-name" itemprop="name">CSUwangj</p>
              <p class="site-description motion-element" itemprop="description">Just keep in mind that hacking is very rarely in a sequence.</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">29</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">28</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/CSUwangj" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:CSUwangj@protonmail.com" target="_blank" title="E-Mail" rel="external nofollow"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
            </div>
          

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc/4.0/" class="cc-opacity" target="_blank" rel="external nofollow">
                <img src="/images/cc-by-nc.svg" alt="Creative Commons" />
              </a>
            </div>
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/0xJDchen/" title="领路人JDchen学长" target="_blank">领路人JDchen学长</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.caomingpei.com/" title="李默瑾" target="_blank">李默瑾</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://huanghantao.github.io/" title="黄含绦" target="_blank">黄含绦</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.cnblogs.com/0xHack/" title="吉祥物" target="_blank">吉祥物</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://wangyx-max.github.io/" title="社会我王哥" target="_blank">社会我王哥</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://wolfbolin.com/" title="WolfBolin" target="_blank">WolfBolin</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://haolovej.com/" title="bocity" target="_blank">bocity</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.yuki-nagato.com/" title="长门有希" target="_blank">长门有希</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://yulige.top/" title="郁离歌" target="_blank">郁离歌</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.jianshu.com/u/fa23d591f030" title="Error404" target="_blank">Error404</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.jianshu.com/u/bf30f18c872c" title="王一航" target="_blank">王一航</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/wushangguo/" title="伍尚国" target="_blank">伍尚国</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.porlockz.com/" title="Porlockz" target="_blank">Porlockz</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://zickshen.github.io/" title="ZickShen" target="_blank">ZickShen</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#为什么在读入的时候不加-amp-经常会-RE，但是数组名不加-amp-就没问题？"><span class="nav-number">1.</span> <span class="nav-text">为什么在读入的时候不加&amp;经常会 RE，但是数组名不加&amp;就没问题？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#在函数里开不了大数组吗？"><span class="nav-number">2.</span> <span class="nav-text">在函数里开不了大数组吗？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#我开了一个很大的全局数组，但是编译无法通过，这是为什么？"><span class="nav-number">3.</span> <span class="nav-text">我开了一个很大的全局数组，但是编译无法通过，这是为什么？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#我开了一个稍小一些的全局数组，为什么编译还是失败了而且错误的原因非常复杂？"><span class="nav-number">4.</span> <span class="nav-text">我开了一个稍小一些的全局数组，为什么编译还是失败了而且错误的原因非常复杂？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#我开了一个很大的全局数组并且通过了编译，可是为什么程序运行依然RE了？（等待更好的答案）"><span class="nav-number">5.</span> <span class="nav-text">我开了一个很大的全局数组并且通过了编译，可是为什么程序运行依然RE了？（等待更好的答案）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#为什么越界会导致-RE？"><span class="nav-number">6.</span> <span class="nav-text">为什么越界会导致 RE？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#为什么有时候越界不会-RE-但是会-TLE-WA？"><span class="nav-number">7.</span> <span class="nav-text">为什么有时候越界不会 RE 但是会 TLE/WA？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#我只定义过一个-left，为什么编译器告诉我-Error-reference-to-39-left-39-is-ambiguous？"><span class="nav-number">8.</span> <span class="nav-text">我只定义过一个 left，为什么编译器告诉我[Error] reference to &#39;left&#39; is ambiguous？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Error-ld-returned-1-exit-status是什么错误？"><span class="nav-number">9.</span> <span class="nav-text">[Error] ld returned 1 exit status是什么错误？</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#additional-relocation-overflows-omitted-from-the-output"><span class="nav-number">9.1.</span> <span class="nav-text">additional relocation overflows omitted from the output</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined-reference-to-WinMain-39"><span class="nav-number">9.2.</span> <span class="nav-text">undefined reference to `WinMain&#39;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cannot-open-output-file-这里是个路径-Permission-denied"><span class="nav-number">9.3.</span> <span class="nav-text">cannot open output file [这里是个路径]: Permission denied</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#总是说的堆栈，是指什么？是数据结构里的堆和栈吗？"><span class="nav-number">10.</span> <span class="nav-text">总是说的堆栈，是指什么？是数据结构里的堆和栈吗？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#参考资料"><span class="nav-number">11.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-CSUwangj"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CSUwangj</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">160k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">4:26</span>
  
</div>


  



  <div class="powered-by">大声地使用 <a class="theme-link" target="_blank" rel="external nofollow" href="https://hexo.io">Hexo</a> ！ v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" rel="external nofollow" href="https://github.com/theme-next/hexo-theme-next">NexT.Mist</a> v6.3.0</div>




        








  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1274292879&web_id=1274292879" language="JavaScript"></script>
  </div>



        
      </div>
    </footer>

    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.3.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.3.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  

  
    <script id="dsq-count-scr" src="https://CSUwangj.disqus.com/count.js" async></script>
  

  
    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'http://CSUwangj.github.io/ACM中一些常见的问题及原因/';
        this.page.identifier = 'ACM中一些常见的问题及原因/';
        this.page.title = 'ACM中一些常见的问题及原因';
        };
      function loadComments () {
        var d = document, s = d.createElement('script');
        s.src = 'https://CSUwangj.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      }
      
        loadComments();
      
    </script>
  





	





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  
  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
      flOptions = {};
      
          flOptions.iconStyle = "box";
      
          flOptions.boxForm = "horizontal";
      
          flOptions.position = "middleRight";
      
          flOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script>

  

  

  

  

  
  
  
  <script src="/lib/bookmark/bookmark.min.js?v=1.0"></script>
  <script type="text/javascript">
  
    bookmark.scrollToMark('auto', "#更多");
  
  </script>


  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('复制成功')
          else $(this).text('复制失败')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('复制')
        }, 300)
      }).append(e)
    })
  </script>


  
</body>
</html>
